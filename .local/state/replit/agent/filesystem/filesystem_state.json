{"file_contents":{"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size }), className)}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ExecutionLog.tsx":{"content":"import { Card } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { CheckCircle2, XCircle, Clock, ArrowRight } from \"lucide-react\";\n\nexport interface LogEntry {\n  id: string;\n  timestamp: number;\n  action: string;\n  status: \"success\" | \"error\" | \"pending\" | \"running\";\n  selector?: string;\n  description?: string;\n}\n\ninterface ExecutionLogProps {\n  entries: LogEntry[];\n  detectedUrl?: string;\n  usedModes?: string[];\n}\n\nexport default function ExecutionLog({ entries, detectedUrl, usedModes }: ExecutionLogProps) {\n  const getStatusIcon = (status: LogEntry[\"status\"]) => {\n    switch (status) {\n      case \"success\":\n        return <CheckCircle2 className=\"h-4 w-4 text-green-500\" />;\n      case \"error\":\n        return <XCircle className=\"h-4 w-4 text-destructive\" />;\n      case \"running\":\n        return <ArrowRight className=\"h-4 w-4 animate-pulse text-primary\" />;\n      case \"pending\":\n        return <Clock className=\"h-4 w-4 text-muted-foreground\" />;\n    }\n  };\n\n  const getStatusBadge = (status: LogEntry[\"status\"]) => {\n    const variants = {\n      success: \"bg-green-500/10 text-green-500 border-green-500/20\",\n      error: \"bg-destructive/10 text-destructive border-destructive/20\",\n      running: \"bg-primary/10 text-primary border-primary/20\",\n      pending: \"bg-muted text-muted-foreground border-muted-foreground/20\",\n    };\n    \n    return (\n      <Badge variant=\"outline\" className={variants[status]} data-testid={`badge-${status}`}>\n        {status}\n      </Badge>\n    );\n  };\n\n  const formatTime = (timestamp: number) => {\n    return new Date(timestamp).toLocaleTimeString(\"en-US\", {\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\",\n    });\n  };\n\n  return (\n    <Card className=\"flex h-full flex-col border\">\n      <div className=\"flex h-10 items-center justify-between border-b px-4\">\n        <h3 className=\"text-sm font-medium\">Execution Log</h3>\n        {usedModes && usedModes.length > 0 && (\n          <div className=\"flex gap-1\">\n            {usedModes.map((mode) => (\n              <Badge key={mode} variant=\"outline\" className=\"text-xs\">\n                {mode}\n              </Badge>\n            ))}\n          </div>\n        )}\n      </div>\n      {detectedUrl && (\n        <div className=\"border-b px-4 py-2 bg-muted/30\">\n          <p className=\"text-xs text-muted-foreground\">Detected URL:</p>\n          <code className=\"text-xs font-mono\">{detectedUrl}</code>\n        </div>\n      )}\n      <ScrollArea className=\"flex-1\">\n        <div className=\"space-y-1 p-2\">\n          {entries.length === 0 ? (\n            <div className=\"flex h-32 items-center justify-center\">\n              <p className=\"text-sm text-muted-foreground\">No actions executed yet</p>\n            </div>\n          ) : (\n            entries.map((entry, index) => (\n              <div\n                key={entry.id}\n                className=\"group relative rounded-md border border-transparent p-3 hover-elevate\"\n                data-testid={`log-entry-${index}`}\n              >\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"mt-0.5\">{getStatusIcon(entry.status)}</div>\n                  <div className=\"flex-1 space-y-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"font-mono text-xs text-muted-foreground\">\n                        {formatTime(entry.timestamp)}\n                      </span>\n                      {getStatusBadge(entry.status)}\n                    </div>\n                    <p className=\"text-sm font-medium\">{entry.action}</p>\n                    {entry.description && (\n                      <p className=\"text-xs text-muted-foreground\">{entry.description}</p>\n                    )}\n                    {entry.selector && (\n                      <code className=\"block rounded bg-muted px-2 py-1 font-mono text-xs\">\n                        {entry.selector}\n                      </code>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </ScrollArea>\n    </Card>\n  );\n}\n","size_bytes":4199},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"fetch_token.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nToken Fetcher Script for VisionVault Custom LLM\n\nThis script is called by the CustomLLMClient to fetch authentication tokens dynamically.\nCustomize this script to implement your token fetching logic.\n\nThe script should output a JSON object with the following structure:\n{\n    \"access_token\": \"your-token-here\",\n    \"expires_in\": 3600  // optional: token expiration in seconds\n}\n\nOr in case of error:\n{\n    \"error\": \"error message here\"\n}\n\"\"\"\n\nimport json\nimport sys\nimport os\n\ndef fetch_token():\n    \"\"\"\n    Implement your custom token fetching logic here.\n    \n    Examples:\n    - Fetch from Azure OAuth endpoint\n    - Retrieve from a token service\n    - Call an authentication API\n    - Read from a rotating credential system\n    \n    For now, this returns a placeholder that you should replace with your actual implementation.\n    \"\"\"\n    \n    # Example: You might call an OAuth endpoint, authentication service, etc.\n    # For demonstration, we'll show how to structure the response\n    \n    try:\n        # TODO: Replace this with your actual token fetching logic\n        # Example patterns:\n        \n        # Pattern 1: Fetch from an OAuth endpoint\n        # import requests\n        # response = requests.post(\"https://your-auth-server.com/oauth/token\", ...)\n        # token = response.json()[\"access_token\"]\n        \n        # Pattern 2: Call a custom authentication API\n        # token = get_token_from_your_service()\n        \n        # Pattern 3: Use environment variable as fallback during development\n        token = os.getenv(\"CUSTOM_LLM_API_KEY\", \"\")\n        \n        if not token:\n            return {\n                \"error\": \"No token available. Please implement token fetching logic in fetch_token.py\"\n            }\n        \n        # Return the token with optional expiration time\n        return {\n            \"access_token\": token,\n            \"expires_in\": 3600  # Token expires in 1 hour (optional)\n        }\n        \n    except Exception as e:\n        return {\n            \"error\": f\"Failed to fetch token: {str(e)}\"\n        }\n\nif __name__ == \"__main__\":\n    result = fetch_token()\n    print(json.dumps(result))\n    sys.exit(0 if \"access_token\" in result else 1)\n","size_bytes":2212},"client/src/pages/Settings.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Button } from \"@/components/ui/button\";\nimport { ArrowLeft, Settings as SettingsIcon } from \"lucide-react\";\nimport { useSettings, type ScreenshotMode } from \"@/contexts/SettingsContext\";\nimport { Link } from \"wouter\";\n\nexport default function Settings() {\n  const { model, setModel, screenshotMode, setScreenshotMode } = useSettings();\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"sticky top-0 z-50 flex h-16 items-center justify-between border-b bg-background px-6\">\n        <div className=\"flex items-center gap-3\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back\">\n              <ArrowLeft className=\"h-5 w-5\" />\n            </Button>\n          </Link>\n          <SettingsIcon className=\"h-6 w-6 text-primary\" />\n          <div>\n            <h1 className=\"text-lg font-semibold\">Settings</h1>\n            <p className=\"text-xs text-muted-foreground\">Configure your preferences</p>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container max-w-4xl py-8 px-6\">\n        <div className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>AI Model Configuration</CardTitle>\n              <CardDescription>\n                Select the AI model to use for browser automation tasks\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"model\" data-testid=\"label-model\">\n                  AI Model\n                </Label>\n                <Select value={model} onValueChange={setModel}>\n                  <SelectTrigger id=\"model\" data-testid=\"select-model\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"google/gemini-2.5-flash\" data-testid=\"select-model-gemini\">\n                      Google Gemini 2.5 Flash (Fast)\n                    </SelectItem>\n                    <SelectItem value=\"openai/gpt-4o\" data-testid=\"select-model-gpt4o\">\n                      OpenAI GPT-4o\n                    </SelectItem>\n                    <SelectItem value=\"openai/gpt-4o-mini\" data-testid=\"select-model-gpt4o-mini\">\n                      OpenAI GPT-4o Mini\n                    </SelectItem>\n                    <SelectItem value=\"anthropic/claude-sonnet-4-20250514\" data-testid=\"select-model-claude\">\n                      Anthropic Claude Sonnet 4\n                    </SelectItem>\n                  </SelectContent>\n                </Select>\n                <p className=\"text-sm text-muted-foreground\">\n                  Your selection will be saved automatically and used for all automation tasks\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Screenshot Configuration</CardTitle>\n              <CardDescription>\n                Configure when to capture screenshots during automation\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <RadioGroup value={screenshotMode} onValueChange={(value) => setScreenshotMode(value as ScreenshotMode)}>\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"every-step\" id=\"every-step\" data-testid=\"radio-every-step\" />\n                  <Label htmlFor=\"every-step\" className=\"font-normal cursor-pointer\">\n                    Screenshot on every step\n                  </Label>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"last-step\" id=\"last-step\" data-testid=\"radio-last-step\" />\n                  <Label htmlFor=\"last-step\" className=\"font-normal cursor-pointer\">\n                    Screenshot on last step\n                  </Label>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"none\" id=\"none\" data-testid=\"radio-none\" />\n                  <Label htmlFor=\"none\" className=\"font-normal cursor-pointer\">\n                    No screenshot\n                  </Label>\n                </div>\n              </RadioGroup>\n              <p className=\"text-sm text-muted-foreground mt-4\">\n                Your selection will be saved automatically and applied to all automation tasks\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Model Information</CardTitle>\n              <CardDescription>\n                Learn about the available AI models\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"space-y-1\">\n                <p className=\"text-sm font-medium\">Google Gemini 2.5 Flash</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Fast and efficient model, great for most automation tasks\n                </p>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-sm font-medium\">OpenAI GPT-4o</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Advanced reasoning capabilities for complex automation scenarios\n                </p>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-sm font-medium\">OpenAI GPT-4o Mini</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Lightweight version with good balance of speed and capability\n                </p>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-sm font-medium\">Anthropic Claude Sonnet 4</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Excellent for nuanced understanding and precise automation\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n    </div>\n  );\n}\n","size_bytes":6435},"server/models.py":{"content":"from sqlalchemy import Column, Integer, String, Boolean, Text, DateTime, JSON, Float\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.sql import func\nfrom datetime import datetime\nfrom typing import List, Dict, Optional\n\nBase = declarative_base()\n\nclass AutomationHistory(Base):\n    __tablename__ = \"automation_history\"\n    \n    id = Column(Integer, primary_key=True, autoincrement=True)\n    prompt = Column(Text, nullable=False)\n    prompt_embedding = Column(JSON, nullable=True)\n    detected_url = Column(Text, nullable=True)\n    mode = Column(String(50), nullable=False)\n    model = Column(String(100), nullable=False)\n    success = Column(Boolean, nullable=False)\n    session_id = Column(String(100), nullable=False)\n    logs = Column(JSON, nullable=False)\n    generated_code = Column(JSON, nullable=False)\n    screenshot = Column(Text, nullable=True)\n    error = Column(Text, nullable=True)\n    created_at = Column(DateTime, nullable=False, default=datetime.utcnow, server_default=func.now())\n    \n    def to_dict(self):\n        return {\n            \"id\": self.id,\n            \"prompt\": self.prompt,\n            \"promptEmbedding\": self.prompt_embedding,\n            \"detectedUrl\": self.detected_url,\n            \"mode\": self.mode,\n            \"model\": self.model,\n            \"success\": self.success,\n            \"sessionId\": self.session_id,\n            \"logs\": self.logs,\n            \"generatedCode\": self.generated_code,\n            \"screenshot\": self.screenshot,\n            \"error\": self.error,\n            \"createdAt\": self.created_at.isoformat() if self.created_at is not None else None\n        }\n","size_bytes":1632},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"server/seed_dummy_data.py":{"content":"\"\"\"\nSeed dummy data for VisionVault database\n\"\"\"\nfrom sqlalchemy.orm import Session\nfrom server.database import SessionLocal, init_db\nfrom server.models import AutomationHistory\nfrom datetime import datetime, timedelta\nimport json\nimport numpy as np\nimport random\n\ndef generate_dummy_embedding():\n    \"\"\"Generate a random 768-dimensional embedding vector\"\"\"\n    return np.random.randn(768).tolist()\n\ndef create_dummy_records():\n    init_db()\n    db = SessionLocal()\n    \n    try:\n        # Dummy record 1: Google Search\n        record1 = AutomationHistory(\n            prompt=\"Go to Google and search for 'web automation tools'\",\n            prompt_embedding=generate_dummy_embedding(),\n            detected_url=\"https://www.google.com\",\n            mode=\"act\",\n            model=\"google/gemini-2.5-flash\",\n            success=True,\n            session_id=f\"session_{random.randint(10000, 99999)}\",\n            logs=[\n                {\n                    \"id\": \"1\",\n                    \"timestamp\": 1699564800000,\n                    \"action\": \"navigate\",\n                    \"status\": \"success\",\n                    \"description\": \"Navigating to https://www.google.com\"\n                },\n                {\n                    \"id\": \"2\",\n                    \"timestamp\": 1699564802000,\n                    \"action\": \"act\",\n                    \"status\": \"success\",\n                    \"selector\": \"xpath=//textarea[@name='q']\",\n                    \"description\": \"Typing 'web automation tools' in search box\"\n                },\n                {\n                    \"id\": \"3\",\n                    \"timestamp\": 1699564804000,\n                    \"action\": \"act\",\n                    \"status\": \"success\",\n                    \"selector\": \"xpath=//input[@name='btnK']\",\n                    \"description\": \"Clicking search button\"\n                }\n            ],\n            generated_code={\n                \"locators\": \"\"\"import { chromium } from 'playwright';\n\nasync function runAutomation() {\n  const browser = await chromium.launch({ headless: false });\n  const page = await browser.newPage();\n  \n  await page.goto('https://www.google.com');\n  await page.locator('xpath=//textarea[@name=\\\"q\\\"]').fill('web automation tools');\n  await page.locator('xpath=//input[@name=\\\"btnK\\\"]').click();\n  \n  await browser.close();\n}\n\nrunAutomation();\"\"\"\n            },\n            screenshot=None,\n            error=None,\n            created_at=datetime.utcnow() - timedelta(days=4)\n        )\n        \n        # Dummy record 2: GitHub Login\n        record2 = AutomationHistory(\n            prompt=\"Navigate to GitHub and click the sign in button\",\n            prompt_embedding=generate_dummy_embedding(),\n            detected_url=\"https://github.com\",\n            mode=\"act\",\n            model=\"google/gemini-2.5-flash\",\n            success=True,\n            session_id=f\"session_{random.randint(10000, 99999)}\",\n            logs=[\n                {\n                    \"id\": \"1\",\n                    \"timestamp\": 1699564800000,\n                    \"action\": \"navigate\",\n                    \"status\": \"success\",\n                    \"description\": \"Navigating to https://github.com\"\n                },\n                {\n                    \"id\": \"2\",\n                    \"timestamp\": 1699564802000,\n                    \"action\": \"act\",\n                    \"status\": \"success\",\n                    \"selector\": \"xpath=//a[contains(text(), 'Sign in')]\",\n                    \"description\": \"Clicking sign in button\"\n                }\n            ],\n            generated_code={\n                \"locators\": \"\"\"import { chromium } from 'playwright';\n\nasync function runAutomation() {\n  const browser = await chromium.launch({ headless: false });\n  const page = await browser.newPage();\n  \n  await page.goto('https://github.com');\n  await page.locator('xpath=//a[contains(text(), \\\"Sign in\\\")]').click();\n  \n  await browser.close();\n}\n\nrunAutomation();\"\"\"\n            },\n            screenshot=None,\n            error=None,\n            created_at=datetime.utcnow() - timedelta(days=3)\n        )\n        \n        # Dummy record 3: Amazon Product Search\n        record3 = AutomationHistory(\n            prompt=\"Search for 'wireless headphones' on Amazon\",\n            prompt_embedding=generate_dummy_embedding(),\n            detected_url=\"https://www.amazon.com\",\n            mode=\"observe\",\n            model=\"google/gemini-2.5-flash\",\n            success=True,\n            session_id=f\"session_{random.randint(10000, 99999)}\",\n            logs=[\n                {\n                    \"id\": \"1\",\n                    \"timestamp\": 1699564800000,\n                    \"action\": \"navigate\",\n                    \"status\": \"success\",\n                    \"description\": \"Navigating to https://www.amazon.com\"\n                },\n                {\n                    \"id\": \"2\",\n                    \"timestamp\": 1699564802000,\n                    \"action\": \"observe\",\n                    \"status\": \"success\",\n                    \"selector\": \"xpath=//input[@id='twotabsearchtextbox']\",\n                    \"description\": \"Found search input field\"\n                },\n                {\n                    \"id\": \"3\",\n                    \"timestamp\": 1699564804000,\n                    \"action\": \"act\",\n                    \"status\": \"success\",\n                    \"selector\": \"xpath=//input[@id='twotabsearchtextbox']\",\n                    \"description\": \"Typed search query\"\n                }\n            ],\n            generated_code={\n                \"locators\": \"\"\"import { chromium } from 'playwright';\n\nasync function runAutomation() {\n  const browser = await chromium.launch({ headless: false });\n  const page = await browser.newPage();\n  \n  await page.goto('https://www.amazon.com');\n  const searchBox = await page.locator('xpath=//input[@id=\\\"twotabsearchtextbox\\\"]');\n  await searchBox.fill('wireless headphones');\n  \n  await browser.close();\n}\n\nrunAutomation();\"\"\"\n            },\n            screenshot=None,\n            error=None,\n            created_at=datetime.utcnow() - timedelta(days=2)\n        )\n        \n        # Dummy record 4: Failed automation\n        record4 = AutomationHistory(\n            prompt=\"Click the non-existent button on example.com\",\n            prompt_embedding=generate_dummy_embedding(),\n            detected_url=\"https://example.com\",\n            mode=\"act\",\n            model=\"google/gemini-2.5-flash\",\n            success=False,\n            session_id=f\"session_{random.randint(10000, 99999)}\",\n            logs=[\n                {\n                    \"id\": \"1\",\n                    \"timestamp\": 1699564800000,\n                    \"action\": \"navigate\",\n                    \"status\": \"success\",\n                    \"description\": \"Navigating to https://example.com\"\n                },\n                {\n                    \"id\": \"2\",\n                    \"timestamp\": 1699564802000,\n                    \"action\": \"act\",\n                    \"status\": \"error\",\n                    \"description\": \"Failed to find element\"\n                }\n            ],\n            generated_code={\n                \"locators\": \"// Automation failed - no code generated\"\n            },\n            screenshot=None,\n            error=\"Element not found: Could not locate the specified button\",\n            created_at=datetime.utcnow() - timedelta(days=1)\n        )\n        \n        # Dummy record 5: Wikipedia Extract\n        record5 = AutomationHistory(\n            prompt=\"Extract the main heading from Wikipedia homepage\",\n            prompt_embedding=generate_dummy_embedding(),\n            detected_url=\"https://www.wikipedia.org\",\n            mode=\"extract\",\n            model=\"google/gemini-2.5-flash\",\n            success=True,\n            session_id=f\"session_{random.randint(10000, 99999)}\",\n            logs=[\n                {\n                    \"id\": \"1\",\n                    \"timestamp\": 1699564800000,\n                    \"action\": \"navigate\",\n                    \"status\": \"success\",\n                    \"description\": \"Navigating to https://www.wikipedia.org\"\n                },\n                {\n                    \"id\": \"2\",\n                    \"timestamp\": 1699564802000,\n                    \"action\": \"extract\",\n                    \"status\": \"success\",\n                    \"selector\": \"xpath=//h1\",\n                    \"description\": \"Extracted main heading text\"\n                }\n            ],\n            generated_code={\n                \"locators\": \"\"\"import { chromium } from 'playwright';\n\nasync function runAutomation() {\n  const browser = await chromium.launch({ headless: false });\n  const page = await browser.newPage();\n  \n  await page.goto('https://www.wikipedia.org');\n  const heading = await page.locator('xpath=//h1').textContent();\n  console.log('Heading:', heading);\n  \n  await browser.close();\n}\n\nrunAutomation();\"\"\"\n            },\n            screenshot=None,\n            error=None,\n            created_at=datetime.utcnow() - timedelta(hours=6)\n        )\n        \n        # Add all records to database\n        db.add_all([record1, record2, record3, record4, record5])\n        db.commit()\n        \n        print(\"✅ Successfully added 5 dummy records to the database\")\n        print(\"\\nRecords added:\")\n        print(\"1. Google Search - web automation tools\")\n        print(\"2. GitHub Sign In\")\n        print(\"3. Amazon Product Search\")\n        print(\"4. Failed automation on example.com\")\n        print(\"5. Wikipedia heading extraction\")\n        \n    except Exception as e:\n        print(f\"❌ Error adding dummy data: {e}\")\n        db.rollback()\n    finally:\n        db.close()\n\nif __name__ == \"__main__\":\n    create_dummy_records()\n","size_bytes":9666},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/examples/CodeOutput.tsx":{"content":"import CodeOutput from \"../CodeOutput\";\n\nexport default function CodeOutputExample() {\n  const sampleCode = `import { Stagehand } from \"@browserbasehq/stagehand\";\nimport { z } from \"zod/v3\";\n\nconst stagehand = new Stagehand({\n  env: \"LOCAL\",\n  model: \"google/gemini-2.5-flash\"\n});\n\nawait stagehand.init();\nconst page = stagehand.context.pages()[0];\n\nawait page.goto(\"https://example.com\");\nawait stagehand.act(\"click the login button\");\n\nawait stagehand.close();`;\n\n  return (\n    <div className=\"h-96\">\n      <CodeOutput typescriptCode={sampleCode} />\n    </div>\n  );\n}\n","size_bytes":571},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/hooks/useWebSocket.ts":{"content":"import { useEffect, useRef, useState, useCallback } from \"react\";\nimport type { WSMessage, LogEntry, AutomationResponse } from \"@shared/schema\";\n\ninterface UseWebSocketOptions {\n  onLog?: (log: LogEntry) => void;\n  onComplete?: (response: AutomationResponse) => void;\n  onError?: (error: string) => void;\n}\n\nexport function useWebSocket({ onLog, onComplete, onError }: UseWebSocketOptions) {\n  const ws = useRef<WebSocket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const currentSessionIdRef = useRef<string | null>(null);\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  \n  // Use refs for callbacks to avoid dependency issues\n  const onLogRef = useRef(onLog);\n  const onCompleteRef = useRef(onComplete);\n  const onErrorRef = useRef(onError);\n  \n  useEffect(() => {\n    onLogRef.current = onLog;\n    onCompleteRef.current = onComplete;\n    onErrorRef.current = onError;\n  }, [onLog, onComplete, onError]);\n\n  const connect = useCallback(() => {\n    if (ws.current?.readyState === WebSocket.OPEN) {\n      return; // Already connected\n    }\n\n    const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n    \n    const socket = new WebSocket(wsUrl);\n\n    socket.onopen = () => {\n      console.log(\"WebSocket connected\");\n      setIsConnected(true);\n      \n      // Resubscribe to session if we have an active one (after reconnect)\n      if (currentSessionIdRef.current) {\n        console.log(`Resubscribing to session: ${currentSessionIdRef.current}`);\n        socket.send(JSON.stringify({ type: \"subscribe\", sessionId: currentSessionIdRef.current }));\n      }\n    };\n\n    socket.onmessage = (event) => {\n      try {\n        const message: WSMessage = JSON.parse(event.data);\n\n        switch (message.type) {\n          case \"log\":\n            onLogRef.current?.(message.log);\n            break;\n          case \"complete\":\n            onCompleteRef.current?.(message.response);\n            break;\n          case \"error\":\n            onErrorRef.current?.(message.error);\n            break;\n        }\n      } catch (error) {\n        console.error(\"Failed to parse WebSocket message:\", error);\n      }\n    };\n\n    socket.onclose = () => {\n      console.log(\"WebSocket disconnected\");\n      setIsConnected(false);\n      // Attempt reconnection after 3 seconds\n      reconnectTimeoutRef.current = setTimeout(connect, 3000);\n    };\n\n    socket.onerror = (error) => {\n      console.error(\"WebSocket error:\", error);\n    };\n\n    ws.current = socket;\n  }, []);\n\n  const subscribe = useCallback((sessionId: string) => {\n    currentSessionIdRef.current = sessionId;\n    \n    if (ws.current?.readyState === WebSocket.OPEN) {\n      console.log(`Subscribing to session: ${sessionId}`);\n      ws.current.send(JSON.stringify({ type: \"subscribe\", sessionId }));\n    } else {\n      // Queue subscription for when socket opens\n      console.log(`Socket not ready, subscription will occur on connect`);\n    }\n  }, []);\n\n  const disconnect = useCallback(() => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n    if (ws.current) {\n      ws.current.close();\n      ws.current = null;\n      setIsConnected(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    connect();\n    return () => {\n      disconnect();\n    };\n  }, [connect, disconnect]);\n\n  return {\n    isConnected,\n    subscribe,\n    currentSessionId: currentSessionIdRef.current,\n  };\n}\n","size_bytes":3532},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"server/intelligent-router.ts":{"content":"import { z } from \"zod\";\nimport type { AutomationMode } from \"@shared/schema\";\n\ninterface ParsedPrompt {\n  url: string;\n  task: string;\n  suggestedMode: AutomationMode;\n  reasoning: string;\n}\n\n/**\n * Extract URL from natural language prompt\n */\nexport function extractUrl(prompt: string): string | null {\n  // Match common URL patterns\n  const urlRegex = /(https?:\\/\\/[^\\s]+)/gi;\n  const matches = prompt.match(urlRegex);\n  \n  if (matches && matches.length > 0) {\n    return matches[0].replace(/[,;.]$/, ''); // Remove trailing punctuation\n  }\n  \n  // Try to find domain-like patterns without protocol\n  const domainRegex = /(?:go to |visit |open |navigate to |on )?([a-zA-Z0-9-]+\\.[a-zA-Z]{2,}(?:\\/[^\\s]*)?)/gi;\n  const domainMatches = prompt.match(domainRegex);\n  \n  if (domainMatches && domainMatches.length > 0) {\n    let domain = domainMatches[0]\n      .replace(/^(?:go to |visit |open |navigate to |on )/i, '')\n      .replace(/[,;.]$/, '');\n    \n    // Add https:// if not present\n    if (!domain.startsWith('http://') && !domain.startsWith('https://')) {\n      domain = 'https://' + domain;\n    }\n    \n    return domain;\n  }\n  \n  return null;\n}\n\n/**\n * Analyze prompt to determine the best automation mode\n */\nexport function suggestMode(prompt: string): {\n  mode: AutomationMode;\n  reasoning: string;\n} {\n  const lowerPrompt = prompt.toLowerCase();\n  \n  // Extract keywords\n  const hasExtractKeywords = /extract|get|scrape|pull|grab|fetch|find data|retrieve/i.test(lowerPrompt);\n  const hasObserveKeywords = /find|locate|check if|see|show|list|discover/i.test(lowerPrompt);\n  const hasActKeywords = /click|type|fill|enter|submit|scroll|press|select|choose/i.test(lowerPrompt);\n  const hasMultiStep = /and then|after|next|finally|then|complete|workflow|process/i.test(lowerPrompt);\n  \n  // Decision logic\n  if (hasMultiStep || (hasActKeywords && hasExtractKeywords)) {\n    return {\n      mode: \"agent\",\n      reasoning: \"Detected multi-step workflow requiring autonomous execution\"\n    };\n  }\n  \n  if (hasExtractKeywords && !hasActKeywords) {\n    return {\n      mode: \"extract\",\n      reasoning: \"Detected data extraction request\"\n    };\n  }\n  \n  if (hasObserveKeywords && !hasActKeywords && !hasExtractKeywords) {\n    return {\n      mode: \"observe\",\n      reasoning: \"Detected element discovery request\"\n    };\n  }\n  \n  if (hasActKeywords) {\n    return {\n      mode: \"act\",\n      reasoning: \"Detected single action request\"\n    };\n  }\n  \n  // Default to agent for complex requests\n  return {\n    mode: \"agent\",\n    reasoning: \"Using agent mode for flexible task execution\"\n  };\n}\n\n/**\n * Parse natural language prompt into structured automation request\n */\nexport function parsePrompt(prompt: string): ParsedPrompt {\n  const url = extractUrl(prompt);\n  \n  if (!url) {\n    throw new Error(\n      \"Could not detect a URL in your prompt. Please include a website URL (e.g., 'https://example.com' or 'go to example.com')\"\n    );\n  }\n  \n  // Remove the URL from the task description\n  const task = prompt\n    .replace(url, '')\n    .replace(/^(?:go to |visit |open |navigate to |on )\\s*/i, '')\n    .trim();\n  \n  const { mode, reasoning } = suggestMode(prompt);\n  \n  return {\n    url,\n    task: task || \"Complete the automation task\",\n    suggestedMode: mode,\n    reasoning,\n  };\n}\n\n/**\n * Generate appropriate code based on the mode used\n */\nexport function generateCodeForMode(\n  mode: AutomationMode,\n  url: string,\n  task: string,\n  model: string\n): string {\n  const baseSetup = `import { Stagehand } from \"@browserbasehq/stagehand\";\nimport { z } from \"zod\";\n\nconst stagehand = new Stagehand({\n  env: \"LOCAL\",\n  model: \"${model}\",\n  enableCaching: true\n});\n\nawait stagehand.init();\nconst page = stagehand.context.pages()[0];\n\nawait page.goto(\"${url}\");`;\n\n  switch (mode) {\n    case \"act\":\n      return `${baseSetup}\n\n// Execute action\nawait page.act(\"${task}\");\n\nawait stagehand.close();`;\n\n    case \"observe\":\n      return `${baseSetup}\n\n// Discover elements\nconst elements = await page.observe(\"${task}\");\nconsole.log(\"Found elements:\", elements);\n\nawait stagehand.close();`;\n\n    case \"extract\":\n      return `${baseSetup}\n\n// Extract data\nconst data = await page.extract({\n  instruction: \"${task}\",\n  schema: z.object({\n    // Define your schema here\n    data: z.string()\n  })\n});\n\nconsole.log(\"Extracted data:\", data);\n\nawait stagehand.close();`;\n\n    case \"agent\":\n      return `${baseSetup}\n\n// Execute multi-step workflow\nconst agent = stagehand.agent({\n  cua: true,\n  model: \"${model}\",\n  systemPrompt: \"You are a helpful automation assistant.\"\n});\n\nconst result = await agent.execute({\n  instruction: \"${task}\",\n  maxSteps: 20\n});\n\nconsole.log(\"Result:\", result.message);\nconsole.log(\"Completed:\", result.completed);\n\nawait stagehand.close();`;\n\n    default:\n      return baseSetup + \"\\n\\nawait stagehand.close();\";\n  }\n}\n","size_bytes":4838},"client/src/components/ScreenshotDisplay.tsx":{"content":"import { Card } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Image as ImageIcon } from \"lucide-react\";\n\ninterface ScreenshotDisplayProps {\n  screenshots: string[];\n}\n\nexport default function ScreenshotDisplay({ screenshots }: ScreenshotDisplayProps) {\n  return (\n    <Card className=\"flex h-full flex-col border\">\n      <div className=\"flex h-10 items-center justify-between border-b px-4\">\n        <h3 className=\"text-sm font-medium\">Screenshot</h3>\n      </div>\n      <ScrollArea className=\"flex-1\">\n        <div className=\"p-4\">\n          {screenshots.length === 0 ? (\n            <div className=\"flex h-64 items-center justify-center border-2 border-dashed rounded-md\">\n              <div className=\"flex flex-col items-center gap-2\">\n                <ImageIcon className=\"h-8 w-8 text-muted-foreground\" />\n                <p className=\"text-sm text-muted-foreground\">No screenshots yet</p>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {screenshots.map((screenshot, index) => (\n                <img\n                  key={index}\n                  src={screenshot}\n                  alt={`Screenshot ${index + 1}`}\n                  className=\"w-full rounded-md border\"\n                  data-testid={`screenshot-${index}`}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      </ScrollArea>\n    </Card>\n  );\n}\n","size_bytes":1466},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { SettingsProvider } from \"@/contexts/SettingsContext\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/app-sidebar\";\nimport ThemeToggle from \"@/components/ThemeToggle\";\nimport { Link } from \"wouter\";\nimport { Settings as SettingsIcon } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport Home from \"@/pages/Home\";\nimport History from \"@/pages/History\";\nimport Cache from \"@/pages/Cache\";\nimport Settings from \"@/pages/Settings\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/history\" component={History} />\n      <Route path=\"/cache\" component={Cache} />\n      <Route path=\"/settings\" component={Settings} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <SettingsProvider>\n          <SidebarProvider defaultOpen={false} style={style as React.CSSProperties}>\n            <div className=\"flex h-screen w-full\">\n              <AppSidebar />\n              <div className=\"flex flex-col flex-1\">\n                <header className=\"flex items-center justify-between gap-2 border-b px-4 py-2\">\n                  <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n                  <div className=\"flex items-center gap-2\">\n                    <Link href=\"/settings\">\n                      <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-settings\">\n                        <SettingsIcon className=\"h-5 w-5\" />\n                      </Button>\n                    </Link>\n                    <ThemeToggle />\n                  </div>\n                </header>\n                <main className=\"flex-1 overflow-hidden\">\n                  <Router />\n                </main>\n              </div>\n            </div>\n          </SidebarProvider>\n          <Toaster />\n        </SettingsProvider>\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2448},"client/src/components/examples/AutomationInput.tsx":{"content":"import AutomationInput from \"../AutomationInput\";\n\nexport default function AutomationInputExample() {\n  return (\n    <AutomationInput\n      onExecute={(data) => console.log(\"Execute automation:\", data)}\n      isExecuting={false}\n    />\n  );\n}\n","size_bytes":243},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"server/locator-generator.ts":{"content":"import { LogEntry } from \"@shared/schema\";\n\nexport interface StagehandStep {\n  action: \"click\" | \"fill\" | \"type\" | \"press\" | \"goto\" | \"extract\" | \"observe\" | \"scroll\";\n  selector?: string; // XPath from Stagehand observe\n  iframeChain?: string[]; // Array of iframe selectors\n  parameters?: {\n    value?: string;\n    text?: string;\n    key?: string;\n  };\n  description?: string;\n}\n\nexport interface LocatorCodeOptions {\n  url: string;\n  model: string;\n  mode: string;\n  steps: StagehandStep[];\n  cacheDir?: string;\n}\n\n/**\n * Normalize Stagehand result or log entry into a structured step\n */\nexport function normalizeStep(\n  action: string,\n  selector?: string,\n  description?: string,\n  value?: string\n): StagehandStep {\n  // Detect if selector contains iframe references\n  const iframeChain: string[] = [];\n  let finalSelector = selector;\n\n  if (selector) {\n    // Check for iframe in XPath (e.g., //iframe[@id='widget']//button)\n    const iframeMatches = selector.match(/\\/\\/iframe(?:\\[@[^\\]]+\\])?/g);\n    if (iframeMatches) {\n      // Extract iframe selectors - keep full XPath with // prefix\n      const parts = selector.split(/\\/\\/iframe(?:\\[@[^\\]]+\\])?/);\n      for (let i = 0; i < iframeMatches.length; i++) {\n        // Keep the full XPath including // prefix\n        iframeChain.push(iframeMatches[i]); // e.g., \"//iframe[@id='widget']\"\n      }\n      // Last part is the final selector - ensure it has // prefix if it's XPath\n      const lastPart = parts[parts.length - 1];\n      finalSelector = lastPart.startsWith('/') ? lastPart : `//${lastPart}`;\n    }\n  }\n\n  // Determine action type from description or action string\n  let actionType: StagehandStep[\"action\"] = \"click\";\n  const lowerAction = action.toLowerCase();\n  \n  if (lowerAction.includes(\"fill\") || lowerAction.includes(\"type\") || lowerAction.includes(\"enter\")) {\n    actionType = value ? \"fill\" : \"type\";\n  } else if (lowerAction.includes(\"press\")) {\n    actionType = \"press\";\n  } else if (lowerAction.includes(\"navigate\") || lowerAction.includes(\"goto\")) {\n    actionType = \"goto\";\n  } else if (lowerAction.includes(\"extract\")) {\n    actionType = \"extract\";\n  } else if (lowerAction.includes(\"observe\") || lowerAction.includes(\"find\")) {\n    actionType = \"observe\";\n  } else if (lowerAction.includes(\"scroll\")) {\n    actionType = \"scroll\";\n  }\n\n  return {\n    action: actionType,\n    selector: finalSelector,\n    iframeChain: iframeChain.length > 0 ? iframeChain : undefined,\n    parameters: value ? { value, text: value } : undefined,\n    description,\n  };\n}\n\n/**\n * Escape string for safe interpolation in TypeScript code\n */\nfunction escapeForTypeScript(str: string): string {\n  return str\n    .replace(/\\\\/g, '\\\\\\\\')  // Escape backslashes\n    .replace(/\"/g, '\\\\\"')     // Escape double quotes\n    .replace(/'/g, \"\\\\'\")     // Escape single quotes\n    .replace(/`/g, '\\\\`')     // Escape backticks\n    .replace(/\\n/g, '\\\\n')    // Escape newlines\n    .replace(/\\r/g, '\\\\r')    // Escape carriage returns\n    .replace(/\\t/g, '\\\\t');   // Escape tabs\n}\n\n/**\n * Generate locator code from selector and iframe chain\n */\nfunction generateLocatorCall(step: StagehandStep): string {\n  if (!step.selector) {\n    return '';\n  }\n\n  // Escape the selector for safe interpolation\n  const escapedSelector = escapeForTypeScript(step.selector);\n  \n  if (step.iframeChain && step.iframeChain.length > 0) {\n    // Use deepLocator for iframe elements with XPath\n    // Each iframe needs xpath= prefix, and the final selector too\n    const iframeXPaths = step.iframeChain.map(iframe => `xpath=${escapeForTypeScript(iframe)}`);\n    const finalXPath = `xpath=${escapedSelector}`;\n    const deepLocatorPath = [...iframeXPaths, finalXPath].join(' >> ');\n    return `page.deepLocator(\"${deepLocatorPath}\")`;\n  } else {\n    // Use regular locator with XPath syntax (xpath=...)\n    // Playwright understands xpath= prefix for XPath selectors\n    return `page.locator(\"xpath=${escapedSelector}\")`;\n  }\n}\n\n/**\n * Generate action code from step\n */\nfunction generateActionCode(step: StagehandStep, indent: string = ''): string {\n  const locatorCall = generateLocatorCall(step);\n  \n  if (!locatorCall) {\n    // No selector-based action\n    if (step.action === 'goto') {\n      return `${indent}// Navigate is handled in initialization`;\n    }\n    const safeDescription = step.description ? escapeForTypeScript(step.description) : 'Unknown action';\n    return `${indent}// ${safeDescription}`;\n  }\n\n  const comment = step.description ? `${indent}// ${escapeForTypeScript(step.description)}\\n` : '';\n  \n  switch (step.action) {\n    case 'click':\n      return `${comment}${indent}await ${locatorCall}.click();`;\n    \n    case 'fill':\n      const fillValue = escapeForTypeScript(step.parameters?.value || step.parameters?.text || '');\n      return `${comment}${indent}await ${locatorCall}.fill(\"${fillValue}\");`;\n    \n    case 'type':\n      const typeValue = escapeForTypeScript(step.parameters?.value || step.parameters?.text || '');\n      return `${comment}${indent}await ${locatorCall}.type(\"${typeValue}\");`;\n    \n    case 'press':\n      const key = escapeForTypeScript(step.parameters?.key || 'Enter');\n      return `${comment}${indent}await ${locatorCall}.press(\"${key}\");`;\n    \n    case 'scroll':\n      return `${comment}${indent}await ${locatorCall}.scrollIntoViewIfNeeded();`;\n    \n    default:\n      return `${comment}${indent}// Unsupported action: ${step.action}`;\n  }\n}\n\n/**\n * Generate complete TypeScript code with locators\n */\nexport function emitLocatorScript(options: LocatorCodeOptions): string {\n  const { url, model, mode, steps, cacheDir } = options;\n  \n  const imports = [\n    `import { Stagehand } from \"@browserbasehq/stagehand\";`,\n  ];\n  \n  // Add Zod import if needed for extract mode\n  if (mode === 'extract' || steps.some(s => s.action === 'extract')) {\n    imports.push(`import { z } from \"zod\";`);\n  }\n\n  const cacheDirConfig = cacheDir ? `\\n  cacheDir: \"${escapeForTypeScript(cacheDir)}\",` : '';\n  const escapedUrl = escapeForTypeScript(url);\n  const escapedModel = escapeForTypeScript(model);\n  \n  const setupCode = `\nconst stagehand = new Stagehand({\n  env: \"LOCAL\",\n  modelName: \"${escapedModel}\",\n  enableCaching: true,${cacheDirConfig}\n  localBrowserLaunchOptions: {\n    headless: false,\n  },\n});\n\nawait stagehand.init();\nconst page = stagehand.context.pages()[0];\n\n// Navigate to the target URL\nawait page.goto(\"${escapedUrl}\", { waitUntil: \"networkidle\" });\n`;\n\n  // Generate action code for each step\n  const actionCodes = steps\n    .filter(step => step.action !== 'goto') // Skip goto as it's in setup\n    .map(step => generateActionCode(step, ''))\n    .filter(code => code.trim().length > 0);\n\n  const cleanupCode = `\n// Close the browser\nawait stagehand.close();\n`;\n\n  const fullCode = `${imports.join('\\n')}\n\n${setupCode}\n${actionCodes.join('\\n\\n')}\n${cleanupCode}`;\n\n  return fullCode.trim();\n}\n\n/**\n * Generate cached version of code (using Stagehand's caching with cacheDir)\n */\nexport function emitCachedScript(options: LocatorCodeOptions): string {\n  const cacheDirSuffix = options.mode === 'agent' ? '-agent' : '-actions';\n  const cacheDir = options.cacheDir || `./cache/${options.mode}${cacheDirSuffix}`;\n  \n  return emitLocatorScript({\n    ...options,\n    cacheDir,\n  });\n}\n","size_bytes":7270},"client/src/pages/Home.tsx":{"content":"import { useState } from \"react\";\nimport UnifiedAutomationInput from \"@/components/UnifiedAutomationInput\";\nimport ExecutionLog from \"@/components/ExecutionLog\";\nimport ScreenshotDisplay from \"@/components/ScreenshotDisplay\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\nimport type { LogEntry, AutomationResponse } from \"@shared/schema\";\n\nexport default function Home() {\n  const [status, setStatus] = useState<\"idle\" | \"running\" | \"completed\" | \"error\">(\"idle\");\n  const [sessionId, setSessionId] = useState<string | undefined>();\n  const [logEntries, setLogEntries] = useState<LogEntry[]>([]);\n  const [generatedCode, setGeneratedCode] = useState<{\n    typescript?: string;\n    cached?: string;\n    agent?: string;\n    locators?: string;\n  }>({});\n  const [detectedUrl, setDetectedUrl] = useState<string>(\"\");\n  const [usedModes, setUsedModes] = useState<string[]>([]);\n  const [screenshots, setScreenshots] = useState<string[]>([]);\n  const { toast } = useToast();\n\n  // WebSocket handlers\n  const { isConnected, subscribe } = useWebSocket({\n    onLog: (log) => {\n      setLogEntries((prev) => [...prev, log]);\n    },\n    onComplete: (response: AutomationResponse) => {\n      setStatus(\"completed\");\n      setGeneratedCode(response.generatedCode);\n      if (response.detectedUrl) setDetectedUrl(response.detectedUrl);\n      if (response.usedModes) setUsedModes(response.usedModes);\n      if (response.screenshot) setScreenshots([response.screenshot]);\n      \n      toast({\n        title: \"Automation completed\",\n        description: \"Your automation has been executed successfully\",\n      });\n    },\n    onError: (error) => {\n      setStatus(\"error\");\n      toast({\n        title: \"Automation failed\",\n        description: error,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleExecute = async (data: { prompt: string; model: string }) => {\n    setStatus(\"running\");\n    setLogEntries([]);\n    setGeneratedCode({});\n    setDetectedUrl(\"\");\n    setUsedModes([]);\n    setScreenshots([]);\n\n    try {\n      const response = await fetch(\"/api/automate-unified\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      const responseData = await response.json();\n\n      if (!response.ok) {\n        throw new Error(responseData.error || \"Automation failed\");\n      }\n\n      // Subscribe to WebSocket for live updates\n      const newSessionId = responseData.sessionId;\n      setSessionId(newSessionId);\n      subscribe(newSessionId);\n    } catch (error) {\n      setStatus(\"error\");\n      toast({\n        title: \"Failed to start automation\",\n        description: error instanceof Error ? error.message : \"Unknown error\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"flex h-full flex-col bg-background\">\n      <main className=\"flex flex-1 flex-col items-center justify-start p-6\">\n        {/* Logo/Title */}\n        <div className=\"mt-24 mb-8 text-center\">\n          <h1 className=\"text-5xl font-light tracking-tight\">VisionVault</h1>\n        </div>\n\n        {/* Input Section */}\n        <div className=\"w-full max-w-2xl mx-auto\">\n          <UnifiedAutomationInput\n            onExecute={handleExecute}\n            isExecuting={status === \"running\"}\n          />\n        </div>\n\n        {/* Results Section - Execution Log and Screenshot side by side */}\n        {(logEntries.length > 0 || status === \"running\") && (\n          <div className=\"mt-8 w-full max-w-6xl grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <ExecutionLog \n              entries={logEntries}\n              detectedUrl={detectedUrl}\n              usedModes={usedModes}\n            />\n            <ScreenshotDisplay screenshots={screenshots} />\n          </div>\n        )}\n\n        {/* Generated Code Section - locator-based code only */}\n        {status === \"completed\" && generatedCode.locators && (\n          <div className=\"mt-6 w-full max-w-6xl\">\n            <div className=\"bg-card border rounded-md p-4\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <h3 className=\"text-lg font-semibold\">Generated Code</h3>\n                <button\n                  onClick={() => {\n                    navigator.clipboard.writeText(generatedCode.locators || '');\n                    toast({\n                      title: \"Copied to clipboard\",\n                      description: \"Code copied successfully\",\n                    });\n                  }}\n                  className=\"px-3 py-1.5 text-sm bg-primary text-primary-foreground rounded-md hover-elevate active-elevate-2\"\n                  data-testid=\"button-copy-script\"\n                >\n                  Copy Code\n                </button>\n              </div>\n              <p className=\"text-sm text-muted-foreground mb-3\">\n                Rerunnable code using locators and deepLocators (no LLM calls needed)\n              </p>\n              <pre className=\"bg-muted p-4 rounded-md overflow-x-auto text-sm font-mono max-h-96 overflow-y-auto\">\n                <code data-testid=\"text-generated-script\">\n                  {generatedCode.locators}\n                </code>\n              </pre>\n            </div>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}\n","size_bytes":5350},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"design_guidelines.md":{"content":"# Design Guidelines: Stagehand Automation Studio\n\n## Design Approach\n\n**Reference-Based Approach**: Drawing inspiration from Linear's technical precision, Vercel's developer focus, and Stripe's polish. This is a utility-focused developer tool requiring efficiency and clarity.\n\n## Core Design Principles\n\n1. **Developer-First**: Clean, technical aesthetic with focus on code and automation workflows\n2. **Real-time Feedback**: Immediate visual response to automation actions\n3. **Information Density**: Maximize useful information without overwhelming\n4. **Progressive Disclosure**: Show complexity only when needed\n\n## Typography\n\n**Font Families:**\n- Primary: Inter (UI elements, labels, buttons)\n- Code: JetBrains Mono (code blocks, selectors, logs)\n\n**Hierarchy:**\n- Page Title: 32px, semibold\n- Section Headers: 20px, medium\n- Body Text: 14px, regular\n- Code/Logs: 13px, monospace\n- Small Labels: 12px, medium\n\n## Layout System\n\n**Spacing Units**: Use Tailwind units of 2, 4, 6, 8, 12, 16, 24, 32\n- Consistent: `p-4`, `gap-6`, `mb-8`, `mt-12`\n- Element spacing: 4-6 units\n- Section spacing: 12-16 units\n- Page margins: 24-32 units\n\n**Grid Structure:**\n- Main container: `max-w-7xl mx-auto`\n- Split-screen layout: 50/50 or 60/40 (input/output)\n- Three-column for detailed views: 25/50/25 (config/preview/code)\n\n## Component Library\n\n### Navigation\n- Top navigation bar with logo, status indicator, session controls\n- Fixed height: `h-16`\n- Subtle border-bottom separator\n\n### Input Panel\n- Prominent URL input field (full width, `h-12`)\n- Natural language prompt textarea (`min-h-24`, auto-expand)\n- Action mode selector (radio group: Act, Observe, Extract, Agent)\n- Execute button (primary CTA, `h-10`)\n- Configuration accordion (model selection, options)\n\n### Automation Preview\n- Live browser viewport display (iframe or screenshot)\n- Overlay indicators for current action\n- Element highlighting during observe mode\n- Loading states with subtle animations\n\n### Execution Log\n- Scrollable timeline of actions (`max-h-96`, overflow-auto)\n- Each log entry: timestamp, action type, status icon, description\n- Expandable details for each step\n- Visual connection lines between steps\n\n### Code Output\n- Syntax-highlighted code block\n- Tab switcher: TypeScript | Cached | Agent\n- Copy button (top-right corner)\n- Download button\n- Line numbers on left\n\n### Status Indicators\n- Badge components for: Running, Success, Error, Waiting\n- Icon + text combinations\n- Semantic styling (green, red, yellow, blue)\n\n## Visual Patterns\n\n### Cards\n- Subtle border: `border border-neutral-200`\n- Rounded corners: `rounded-lg`\n- Internal padding: `p-6`\n- Background: `bg-white`\n\n### Code Blocks\n- Dark theme for code: `bg-neutral-900`\n- Light text: `text-neutral-100`\n- Padding: `p-4`\n- Scrollable: `overflow-x-auto`\n\n### Forms\n- Input fields: `h-10`, `px-3`, `rounded-md`, `border`\n- Focus ring: `focus:ring-2 focus:ring-blue-500`\n- Label above input: `mb-2`, `text-sm`, `font-medium`\n\n### Buttons\n- Primary: Solid, high contrast, `px-4 py-2`\n- Secondary: Outlined, `border-2`\n- Icon buttons: Square, `w-10 h-10`\n- Disabled state: 40% opacity\n\n## Page Layouts\n\n### Main Automation View (Split Screen)\n\n**Left Panel (40%):**\n- URL input at top\n- Natural language prompt textarea\n- Mode selector (tabs or radio)\n- Execute button\n- Configuration section (collapsed by default)\n\n**Right Panel (60%):**\n- Top: Browser preview (60% height)\n- Bottom: Execution log (40% height)\n- Resizable divider between them\n\n### Code Output View\n\nFull-width code panel appears below when automation completes:\n- Tab switcher for different formats\n- Syntax highlighting\n- Action buttons (Copy, Download, Re-run)\n\n### Alternative: Three-Column Layout\n\n**Left (30%):** Input controls\n**Center (40%):** Live preview\n**Right (30%):** Log + Code output (tabbed)\n\n## Animations\n\n**Minimal and purposeful:**\n- Fade in: New log entries (150ms)\n- Slide down: Expandable sections (200ms)\n- Pulse: Active element indicator\n- Progress bar: During automation execution\n\n**No:**\n- Elaborate transitions\n- Decorative animations\n- Carousel effects\n\n## Images\n\n**No hero image needed** - This is a utility-focused application tool. The interface itself is the hero.\n\n**Icons:**\n- Use Heroicons throughout for consistency\n- 16px or 20px sizes\n- Inline with text where appropriate\n\n**Status Icons:**\n- Checkmark: Success\n- X: Error\n- Clock: Waiting\n- Arrow: In progress\n\n## Specific Features\n\n### Action Preview (Observe Mode)\n- Highlight detected elements with subtle border\n- Show action labels on hover\n- Display confidence scores as small badges\n\n### Selector Display\n- Monospace font for XPath/CSS\n- Inline copy button\n- Syntax highlighting for selector type\n\n### Session Controls\n- Start/Stop buttons in header\n- Session ID display\n- Link to Browserbase session (if applicable)\n\n### Model Selector\n- Dropdown with popular models at top\n- Grouped by provider (OpenAI, Anthropic, Google)\n- CUA models marked with badge\n\n## Responsive Behavior\n\n**Desktop (primary):** Three-column or split layout\n**Tablet:** Stack panels vertically, maintain readability\n**Mobile:** Single column, collapsible sections\n\n## Accessibility\n\n- All interactive elements keyboard accessible\n- Focus indicators on all inputs\n- ARIA labels for icon-only buttons\n- High contrast text (4.5:1 minimum)\n- Screen reader announcements for status changes\n\n## Professional Polish\n\n- Consistent 8px grid alignment\n- Uniform border radius (6px for cards, 4px for inputs)\n- Cohesive elevation system (subtle shadows)\n- Thoughtful empty states with helpful messages\n- Error states with actionable guidance\n- Loading skeletons for async content","size_bytes":5657},"server/websocket.ts":{"content":"import { WebSocketServer, WebSocket } from \"ws\";\nimport type { Server } from \"http\";\nimport type { WSMessage } from \"@shared/schema\";\n\nconst sessions = new Map<string, Set<WebSocket>>();\n\nexport function setupWebSocket(server: Server): WebSocketServer {\n  const wss = new WebSocketServer({ server, path: \"/ws\" });\n\n  wss.on(\"connection\", (ws: WebSocket) => {\n    console.log(\"WebSocket client connected\");\n\n    ws.on(\"message\", (data: Buffer) => {\n      try {\n        const message = JSON.parse(data.toString());\n        \n        // Client subscribing to a session\n        if (message.type === \"subscribe\" && message.sessionId) {\n          if (!sessions.has(message.sessionId)) {\n            sessions.set(message.sessionId, new Set());\n          }\n          sessions.get(message.sessionId)!.add(ws);\n          console.log(`Client subscribed to session: ${message.sessionId}`);\n        }\n      } catch (error) {\n        console.error(\"WebSocket message error:\", error);\n      }\n    });\n\n    ws.on(\"close\", () => {\n      // Remove this socket from all sessions\n      sessions.forEach((clients, sessionId) => {\n        clients.delete(ws);\n        if (clients.size === 0) {\n          sessions.delete(sessionId);\n        }\n      });\n      console.log(\"WebSocket client disconnected\");\n    });\n\n    ws.on(\"error\", (error) => {\n      console.error(\"WebSocket error:\", error);\n    });\n  });\n\n  return wss;\n}\n\nexport function broadcastToSession(sessionId: string, message: WSMessage): void {\n  const clients = sessions.get(sessionId);\n  if (!clients) return;\n\n  const data = JSON.stringify(message);\n  clients.forEach((client) => {\n    if (client.readyState === WebSocket.OPEN) {\n      client.send(data);\n    }\n  });\n}\n","size_bytes":1710},"client/src/pages/Cache.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Database, Loader2, Sparkles } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport type { AutomationHistory } from \"@shared/schema\";\n\nexport default function Cache() {\n  const [selectedCache, setSelectedCache] = useState<AutomationHistory | null>(null);\n\n  const { data, isLoading } = useQuery<{ success: boolean; cache: AutomationHistory[] }>({\n    queryKey: [\"/api/cache\"],\n  });\n\n  const formatDate = (date: Date) => {\n    return new Intl.DateTimeFormat(\"en-US\", {\n      month: \"short\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    }).format(new Date(date));\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex h-full items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  const cache = data?.cache || [];\n\n  return (\n    <div className=\"flex h-full gap-4 p-4\">\n      <div className=\"flex-1 flex flex-col gap-4\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold\">Semantic Cache</h1>\n            <p className=\"text-sm text-muted-foreground mt-1\">\n              Cached automations that can be reused for similar prompts\n            </p>\n          </div>\n          <Badge variant=\"secondary\" className=\"text-sm\">\n            <Database className=\"h-3 w-3 mr-1\" />\n            {cache.length} cached\n          </Badge>\n        </div>\n\n        {cache.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center h-64\">\n              <Sparkles className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <p className=\"text-lg font-medium text-muted-foreground\">No cached automations yet</p>\n              <p className=\"text-sm text-muted-foreground\">\n                Run some automations to build your semantic cache\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          <ScrollArea className=\"flex-1\">\n            <div className=\"space-y-4\">\n              {cache.map((item) => (\n                <Card\n                  key={item.id}\n                  className={`cursor-pointer transition-colors hover-elevate ${\n                    selectedCache?.id === item.id ? \"ring-2 ring-primary\" : \"\"\n                  }`}\n                  onClick={() => setSelectedCache(item)}\n                  data-testid={`cache-item-${item.id}`}\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex-1 min-w-0\">\n                        <CardTitle className=\"text-base truncate\">{item.prompt}</CardTitle>\n                        <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n                          <Badge variant=\"secondary\" className=\"text-xs\">\n                            <Sparkles className=\"h-3 w-3 mr-1\" />\n                            Cached\n                          </Badge>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {item.mode}\n                          </Badge>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {item.model}\n                          </Badge>\n                          <span className=\"text-xs text-muted-foreground\">\n                            {formatDate(item.createdAt)}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  {item.detectedUrl && (\n                    <CardContent className=\"pt-0\">\n                      <p className=\"text-sm text-muted-foreground truncate\">{item.detectedUrl}</p>\n                    </CardContent>\n                  )}\n                </Card>\n              ))}\n            </div>\n          </ScrollArea>\n        )}\n      </div>\n\n      <div className=\"w-96\">\n        {selectedCache ? (\n          <Card className=\"h-full flex flex-col\">\n            <CardHeader>\n              <CardTitle className=\"text-base\">Cache Details</CardTitle>\n            </CardHeader>\n            <CardContent className=\"flex-1 flex flex-col gap-4 overflow-hidden\">\n              <div>\n                <p className=\"text-sm font-medium mb-2\">Prompt</p>\n                <p className=\"text-sm text-muted-foreground border rounded-md p-3\">\n                  {selectedCache.prompt}\n                </p>\n              </div>\n              \n              {selectedCache.detectedUrl && (\n                <div>\n                  <p className=\"text-sm font-medium mb-2\">URL</p>\n                  <p className=\"text-sm text-muted-foreground border rounded-md p-3 truncate\">\n                    {selectedCache.detectedUrl}\n                  </p>\n                </div>\n              )}\n\n              {selectedCache.screenshot && (\n                <div>\n                  <p className=\"text-sm font-medium mb-2\">Screenshot</p>\n                  <img\n                    src={selectedCache.screenshot}\n                    alt=\"Cache screenshot\"\n                    className=\"w-full rounded-md border\"\n                    data-testid={`cache-screenshot-${selectedCache.id}`}\n                  />\n                </div>\n              )}\n\n              <div>\n                <p className=\"text-sm font-medium mb-2\">Generated Code</p>\n                <ScrollArea className=\"h-48 border rounded-md p-3\">\n                  <pre className=\"text-xs\">\n                    <code>{selectedCache.generatedCode.typescript || \"No code generated\"}</code>\n                  </pre>\n                </ScrollArea>\n              </div>\n\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Sparkles className=\"h-4 w-4\" />\n                <p>\n                  This automation is semantically indexed. Similar prompts will reuse this cache\n                  automatically.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        ) : (\n          <Card className=\"h-full flex items-center justify-center\">\n            <CardContent className=\"text-center\">\n              <p className=\"text-muted-foreground\">Select a cache item to view details</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":6612},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"server/custom-llm-client.ts":{"content":"import { spawn } from \"child_process\";\nimport { LLMClient, CreateChatCompletionOptions, LLMResponse, AvailableModel } from \"@browserbasehq/stagehand\";\nimport https from \"https\";\n\nexport class CustomLLMClient extends LLMClient {\n    type = \"custom\";\n    private apiEndpoint: string;\n    private actualModelName: string;\n    private cachedToken: string | null = null;\n    private tokenExpiry: number = 0;\n\n    constructor({\n        modelName = \"gpt-4o\" as AvailableModel,\n        apiEndpoint,\n        actualModelName = \"gpt-4o-1-2025-04-14-eastus-dz\",\n    }: {\n        modelName?: AvailableModel;\n        apiEndpoint: string;\n        actualModelName?: string;\n    }) {\n        super(modelName);\n        this.type = \"custom\";\n        this.apiEndpoint = apiEndpoint;\n        this.actualModelName = actualModelName;\n        this.hasVision = false;\n    }\n\n    private async getToken(): Promise<string> {\n        const now = Date.now();\n        \n        if (this.cachedToken && this.tokenExpiry > now) {\n            return this.cachedToken;\n        }\n\n        const tokenData = await this.fetchOAuthConfig();\n        const accessToken = tokenData.access_token;\n        \n        if (typeof accessToken !== \"string\" || !accessToken) {\n            throw new Error(\"OAuth token is invalid or missing\");\n        }\n        \n        this.cachedToken = accessToken;\n        \n        if (tokenData.expires_in) {\n            this.tokenExpiry = now + (tokenData.expires_in * 1000) - 60000;\n        } else {\n            this.tokenExpiry = now + 3600000;\n        }\n\n        return accessToken;\n    }\n\n    async createChatCompletion<T = LLMResponse & { usage?: LLMResponse[\"usage\"] }>(\n        createOptions: CreateChatCompletionOptions\n    ): Promise<T> {\n        const { messages, temperature, maxTokens, response_model } = createOptions.options;\n        let retries = createOptions.retries ?? 3;\n        let logger = createOptions.logger;\n\n        try {\n            const token = await this.getToken();\n            \n            const requestPayload: any = {\n                model: this.actualModelName,\n                messages: messages.map(msg => ({\n                    role: msg.role,\n                    content: typeof msg.content === \"string\" ? msg.content : JSON.stringify(msg.content),\n                })),\n                temperature,\n                max_tokens: maxTokens,\n            };\n\n            const requestBody = JSON.stringify(requestPayload);\n\n            const data = await new Promise<any>((resolve, reject) => {\n                try {\n                    const url = new URL(this.apiEndpoint);\n\n                    const options = {\n                        hostname: url.hostname,\n                        port: url.port || 443,\n                        path: url.pathname + url.search,\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            \"Authorization\": `Bearer ${token}`,\n                            \"Content-Length\": Buffer.byteLength(requestBody),\n                        },\n                    };\n\n                    const req = https.request(options, (res) => {\n                        let responseData = \"\";\n                        res.on(\"data\", (chunk) => {\n                            responseData += chunk;\n                        });\n\n                        res.on(\"end\", () => {\n                            if (res.statusCode && res.statusCode >= 200 && res.statusCode < 300) {\n                                try {\n                                    const parsed = JSON.parse(responseData);\n                                    resolve(parsed);\n                                } catch (e) {\n                                    reject(new Error(`Failed to parse response: ${responseData}`));\n                                }\n                            } else {\n                                reject(new Error(`API request failed with status ${res.statusCode}: ${responseData}`));\n                            }\n                        });\n                    });\n\n                    req.on(\"error\", (error) => {\n                        reject(error);\n                    });\n\n                    req.write(requestBody);\n                    req.end();\n                } catch (error) {\n                    logger({\n                        category: \"custom-llm\",\n                        message: `Error creating request: ${(error instanceof Error ? error.message : String(error))}`,\n                        level: 0,\n                    });\n                    reject(error);\n                }\n            });\n\n            const messageContent = data.choices?.[0]?.message?.content || data.content || \"\";\n            const toolCalls = data.choices?.[0]?.message?.tool_calls;\n\n            const messageObj: any = {\n                role: \"assistant\",\n                content: messageContent,\n            };\n            if (toolCalls && Array.isArray(toolCalls) && toolCalls.length > 0) {\n                messageObj.tool_calls = toolCalls;\n            }\n\n            const formattedResponse: LLMResponse = {\n                id: `custom-${Date.now()}`,\n                object: \"chat.completion\",\n                created: Math.floor(Date.now() / 1000),\n                model: this.actualModelName,\n                choices: [\n                    {\n                        index: 0,\n                        message: messageObj,\n                        finish_reason: data.choices?.[0]?.finish_reason || \"stop\",\n                    },\n                ],\n                usage: {\n                    prompt_tokens: data.usage?.prompt_tokens || 0,\n                    completion_tokens: data.usage?.completion_tokens || 0,\n                    total_tokens: data.usage?.total_tokens || 0,\n                },\n            };\n\n            if (response_model) {\n                logger({\n                    category: \"custom-llm\",\n                    message: `Response model requested, parsing: ${messageContent}`,\n                    level: 1,\n                });\n                try {\n                    const parsedData = JSON.parse(messageContent);\n                    logger({\n                        category: \"custom-llm\",\n                        message: `Parsed ${JSON.stringify(parsedData, null, 2)}`,\n                        level: 1,\n                    });\n                    if (parsedData && typeof parsedData === \"object\") {\n                        if (parsedData.element && parsedData.action) {\n                            const elementId = parsedData.element.id?.replace(/[^\\[\\]1]/g, \"\") || \"0-1\";\n                            const normalizedData = {\n                                elementId,\n                                method: parsedData.action,\n                                arguments: parsedData.argument ? [parsedData.argument] : (parsedData.arguments || []),\n                            };\n                            logger({\n                                category: \"custom-llm\",\n                                message: `Normalized data (element/action format): ${JSON.stringify(normalizedData, null, 2)}`,\n                                level: 1,\n                            });\n                            return {\n                                ...normalizedData,\n                                usage: formattedResponse.usage,\n                            } as T;\n                        }\n                        if (parsedData.elementId && parsedData.action) {\n                            const normalizedData = {\n                                elementId: parsedData.elementId,\n                                method: parsedData.action,\n                                arguments: parsedData.argument ? [parsedData.argument] : (parsedData.arguments || []),\n                            };\n                            logger({\n                                category: \"custom-llm\",\n                                message: `Normalized data (elementId/action format): ${JSON.stringify(normalizedData, null, 2)}`,\n                                level: 1,\n                            });\n                            return {\n                                ...normalizedData,\n                                usage: formattedResponse.usage,\n                            } as T;\n                        }\n                    }\n                    return {\n                        ...parsedData,\n                        usage: formattedResponse.usage,\n                    } as T;\n                } catch (e) {\n                    logger({\n                        category: \"custom-llm\",\n                        message: `Failed to parse JSON, attempting extraction: ${e instanceof Error ? e.message : String(e)}`,\n                        level: 1,\n                    });\n\n                    const jsonMatch = messageContent.match(/[\\[{][\\s\\S]*[\\]}]/);\n                    if (jsonMatch) {\n                        try {\n                            const extractedJson = JSON.parse(jsonMatch[0]);\n                            logger({\n                                category: \"custom-llm\",\n                                message: `Extracted JSON: ${JSON.stringify(extractedJson, null, 2)}`,\n                                level: 1,\n                            });\n                            if (extractedJson.element && extractedJson.action) {\n                                const elementId = extractedJson.element.id?.replace(/[^\\[\\]1]/g, \"\") || \"0-1\";\n                                const normalizedData = {\n                                    elementId,\n                                    method: extractedJson.action,\n                                    arguments: extractedJson.argument ? [extractedJson.argument] : (extractedJson.arguments || []),\n                                };\n                                logger({\n                                    category: \"custom-llm\",\n                                    message: `Normalized data (extracted): ${JSON.stringify(normalizedData, null, 2)}`,\n                                    level: 1,\n                                });\n                                return {\n                                    ...normalizedData,\n                                    usage: formattedResponse.usage,\n                                } as T;\n                            }\n                            return {\n                                ...extractedJson,\n                                usage: formattedResponse.usage,\n                            } as T;\n                        } catch (e2) {\n                            logger({\n                                category: \"custom-llm\",\n                                message: `Extraction also failed: ${e2 instanceof Error ? e2.message : String(e2)}`,\n                                level: 1,\n                            });\n                        }\n                    }\n                }\n            }\n\n            return formattedResponse as T;\n        } catch (error) {\n            logger({\n                category: \"custom-llm\",\n                message: `Error: ${error instanceof Error ? error.message : String(error)}`,\n                level: 0,\n            });\n            if (retries > 0) {\n                return this.createChatCompletion({ \n                    options: createOptions.options, \n                    logger, \n                    retries: retries - 1 \n                });\n            }\n            throw error;\n        }\n    }\n\n    async fetchOAuthConfig(): Promise<any> {\n        return new Promise((resolve, reject) => {\n            const pythonProcess = spawn(\"python\", [\"fetch_token.py\"]);\n            let output = \"\";\n            let errorOutput = \"\";\n            pythonProcess.stdout.on(\"data\", (data) => {\n                output += data.toString();\n            });\n            pythonProcess.stderr.on(\"data\", (data) => {\n                errorOutput += data.toString();\n            });\n            pythonProcess.on(\"close\", (code) => {\n                if (code !== 0) {\n                    reject(new Error(`Python script failed: ${errorOutput}`));\n                } else {\n                    try {\n                        const result = JSON.parse(output.trim());\n                        if (result.error) {\n                            reject(new Error(`OAuth error: ${result.error}`));\n                        } else {\n                            resolve(result);\n                        }\n                    } catch (e) {\n                        reject(new Error(`Failed to parse OAuth response: ${output}`));\n                    }\n                }\n            });\n        });\n    }\n}\n","size_bytes":12698},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"LOCAL_SETUP.md":{"content":"# VisionVault - Local Setup Guide\n\n## Prerequisites\n\nBefore you begin, ensure you have the following installed:\n\n- **Node.js** (v20 or higher) - [Download here](https://nodejs.org/)\n- **Python** (v3.11 or higher) - [Download here](https://www.python.org/downloads/)\n- **Git** - [Download here](https://git-scm.com/)\n\n## Installation Steps\n\n### 1. Download from Replit (if applicable)\n\nIf you're downloading this project from Replit:\n1. Navigate to the **Files** tool in your Replit workspace\n2. Select the option to download the entire folder\n3. Extract the downloaded ZIP file\n\nAlternatively, clone from Git:\n```bash\ngit clone <your-repo-url>\ncd visionvault\n```\n\n### 2. Install Node.js Dependencies\n\n```bash\nnpm install\n```\n\n### 3. Install Python Dependencies\n\nCreate a Python virtual environment and install packages:\n\n```bash\n# Create virtual environment\npython -m venv .pythonlibs\n\n# Activate virtual environment\n# On macOS/Linux:\nsource .pythonlibs/bin/activate\n# On Windows:\n.pythonlibs\\Scripts\\activate\n\n# Install dependencies\npip install uvicorn fastapi sqlalchemy numpy\n```\n\n### 4. Database Setup\n\n**No manual database setup required!** VisionVault uses SQLite, which automatically creates the database file (`visionvault.db`) on first run.\n\n### 5. API Keys Setup\n\nVisionVault requires AI model API keys. Create a `.env` file in the project root:\n\n```bash\n# Google Gemini (recommended for embeddings and automation)\nGOOGLE_AI_API_KEY=your_gemini_api_key\n\n# OpenAI (optional alternative)\nOPENAI_API_KEY=your_openai_api_key\n\n# Browserbase (optional - for cloud browser automation)\nBROWSERBASE_API_KEY=your_browserbase_key\nBROWSERBASE_PROJECT_ID=your_project_id\n\n# Node Environment\nNODE_ENV=development\n```\n\n**Get API Keys:**\n- **Gemini API**: [Google AI Studio](https://makersuite.google.com/app/apikey)\n- **OpenAI API**: [OpenAI Platform](https://platform.openai.com/api-keys)\n- **Browserbase**: [Browserbase Dashboard](https://www.browserbase.com/)\n\n### 6. Run the Application\n\nThe application uses both Node.js and Python servers:\n\n#### Development Mode (with hot reload)\n\n```bash\n# Make the startup script executable (macOS/Linux only)\nchmod +x start-servers.sh\n\n# Start both servers\n./start-servers.sh\n```\n\n**On Windows**, run both servers manually in separate terminals:\n\nTerminal 1 (Python API):\n```bash\npython -m uvicorn server.main:app --host 0.0.0.0 --port 8000 --reload\n```\n\nTerminal 2 (Node.js):\n```bash\nnpm run dev\n```\n\nThe application will be available at:\n- **Frontend**: http://localhost:5000\n- **Node.js Backend**: http://localhost:5000/api\n- **Python API**: http://localhost:8000\n\n#### Production Mode\n\n```bash\n# Build the frontend\nnpm run build\n\n# Start both servers in production mode\npython -m uvicorn server.main:app --host 0.0.0.0 --port 8000 &\nnpm run start\n```\n\n## Project Structure\n\n```\nvisionvault/\n├── client/                  # Frontend React application\n│   ├── src/\n│   │   ├── pages/          # Page components (Home, History, Cache)\n│   │   ├── components/     # Reusable UI components\n│   │   └── lib/            # Utilities and helpers\n├── server/                 # Backend servers\n│   ├── index.ts           # Node.js Express server (port 5000)\n│   ├── routes.ts          # API routes for automation\n│   ├── locator-generator.ts  # Playwright code generation\n│   ├── main.py            # Python FastAPI server (port 8000)\n│   ├── models.py          # SQLAlchemy database models\n│   ├── database.py        # SQLite connection\n│   └── api-client.ts      # Node→Python API client\n├── shared/                # Shared types and schemas\n│   └── schema.ts          # TypeScript schemas\n├── visionvault.db         # SQLite database (auto-created)\n└── package.json\n```\n\n## Architecture\n\n**Hybrid Node.js + Python Setup:**\n- **Node.js (Port 5000)**: Frontend + Stagehand browser automation + WebSocket logs\n- **Python (Port 8000)**: Database operations + Semantic search with NumPy\n- **Database**: SQLite with JSON-stored embeddings (768-dimensional vectors)\n\n## Available Scripts\n\n```bash\n# Development\nnpm run dev              # Start Node.js dev server only\n./start-servers.sh       # Start both Node.js + Python servers\n\n# Production\nnpm run build            # Build frontend for production\nnpm run start            # Start production server\n```\n\n## Troubleshooting\n\n### Port Already in Use\n\n**Port 5000 conflict:**\n```bash\n# On macOS/Linux\nlsof -ti:5000 | xargs kill -9\n\n# On Windows\nnetstat -ano | findstr :5000\ntaskkill /PID <PID> /F\n```\n\n**Port 8000 conflict (Python API):**\n```bash\n# On macOS/Linux\nlsof -ti:8000 | xargs kill -9\n\n# On Windows\nnetstat -ano | findstr :8000\ntaskkill /PID <PID> /F\n```\n\n### Python Server Not Starting\n\nIf you get \"No module named uvicorn\":\n\n```bash\n# Activate virtual environment\nsource .pythonlibs/bin/activate  # macOS/Linux\n.pythonlibs\\Scripts\\activate     # Windows\n\n# Install dependencies\npip install uvicorn fastapi sqlalchemy numpy\n```\n\n### Database Issues\n\nThe SQLite database is automatically created. If you have issues:\n\n```bash\n# Delete and recreate database\nrm visionvault.db\n\n# Restart the servers - database will be recreated\n./start-servers.sh\n```\n\n### Missing API Keys\n\nIf automation fails with API errors:\n\n1. Check your `.env` file has `GOOGLE_AI_API_KEY` set\n2. Verify the API key is valid at [Google AI Studio](https://makersuite.google.com/app/apikey)\n3. Restart the servers after adding the key\n\n### Node Module Errors\n\n```bash\n# Clear and reinstall\nrm -rf node_modules package-lock.json\nnpm install\n```\n\n## Features\n\n- ✅ **Natural Language Automation**: Describe tasks in plain English\n- ✅ **Locator-Based Code Generation**: Generates rerunnable Playwright code with XPath\n- ✅ **Semantic Caching**: Uses Gemini embeddings (768-dim) for intelligent caching\n- ✅ **Element Highlighting**: Visual feedback during automation\n- ✅ **Execution History**: View, replay, and delete past automations\n- ✅ **Screenshot Capture**: Automatic screenshots of results\n- ✅ **Multi-Mode Support**: act, observe, extract, and agent modes\n\n## Tech Stack\n\n- **Frontend**: React + Vite + TailwindCSS + shadcn/ui\n- **Node.js Backend**: Express.js + TypeScript + Stagehand\n- **Python Backend**: FastAPI + SQLAlchemy + NumPy\n- **Database**: SQLite (file-based, no setup required)\n- **AI Models**: Google Gemini 2.5 Flash (or OpenAI GPT-4)\n- **Browser Automation**: Playwright via Stagehand\n\n## Development Tips\n\n1. **Both servers must run**: The Node.js server handles automation, Python handles database\n2. **Database location**: `visionvault.db` file in project root\n3. **View data**: Use a SQLite browser like [DB Browser for SQLite](https://sqlitebrowser.org/)\n4. **API endpoints**:\n   - Node.js automation: `http://localhost:5000/api/automate`\n   - Python history: `http://localhost:8000/api/history`\n   - Python cache: `http://localhost:8000/api/cache`\n5. **WebSocket logs**: Real-time automation logs at `ws://localhost:5000`\n\n## Seed Dummy Data\n\nTo add sample automation records for testing:\n\n```bash\n# Activate Python virtual environment first\nsource .pythonlibs/bin/activate  # macOS/Linux\n.pythonlibs\\Scripts\\activate     # Windows\n\n# Run seed script\npython server/seed_dummy_data.py\n```\n\nThis adds 5 sample automation records with embeddings.\n\n## Next Steps\n\n1. ✅ Install Node.js and Python dependencies\n2. ✅ Get your Gemini API key from [Google AI Studio](https://makersuite.google.com/app/apikey)\n3. ✅ Add API key to `.env` file\n4. ✅ Run `./start-servers.sh` (or both servers manually on Windows)\n5. ✅ Open http://localhost:5000\n6. ✅ Try: \"Go to example.com and find the heading\"\n\n## Example Automations to Try\n\n```\nGo to Google and search for 'web automation tools'\nNavigate to GitHub and click the sign in button\nExtract the main heading from Wikipedia\nGo to Amazon and search for 'wireless headphones'\n```\n\n## Support\n\nFor issues or questions:\n- Check the Troubleshooting section above\n- Review terminal logs from both Node.js and Python servers\n- Check browser console for frontend errors\n- Verify both servers are running on ports 5000 and 8000\n\n---\n\n**Happy Automating! 🚀**\n","size_bytes":8226},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"server/storage.ts":{"content":"import { randomUUID } from \"crypto\";\n\n// Simple user type for in-memory storage\ninterface User {\n  id: string;\n  username: string;\n  password?: string;\n}\n\ninterface InsertUser {\n  username: string;\n  password?: string;\n}\n\n// modify the interface with any CRUD methods\n// you might need\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n\n  constructor() {\n    this.users = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n}\n\nexport const storage = new MemStorage();\n","size_bytes":1116},"client/src/pages/History.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Trash2, RotateCcw, AlertCircle, Check, X, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport type { AutomationHistory } from \"@shared/schema\";\nimport { useLocation } from \"wouter\";\n\nexport default function History() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [selectedHistory, setSelectedHistory] = useState<AutomationHistory | null>(null);\n\n  const { data, isLoading } = useQuery<{ success: boolean; history: AutomationHistory[] }>({\n    queryKey: [\"/api/history\"],\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return await apiRequest(\"DELETE\", `/api/history/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/history\"] });\n      toast({\n        title: \"Deleted successfully\",\n        description: \"History item has been removed\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Delete failed\",\n        description: \"Failed to delete history item\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteAllMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"DELETE\", \"/api/history\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/history\"] });\n      toast({\n        title: \"All history cleared\",\n        description: \"All history items have been removed\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Clear all failed\",\n        description: \"Failed to clear all history\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const reexecuteMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const response = await apiRequest(\"POST\", `/api/history/${id}/reexecute`);\n      return response.json();\n    },\n    onSuccess: (data) => {\n      setLocation(\"/\");\n      setTimeout(() => {\n        const event = new CustomEvent(\"reexecute-automation\", { detail: data });\n        window.dispatchEvent(event);\n      }, 100);\n      toast({\n        title: \"Reexecuting automation\",\n        description: \"Redirecting to home page...\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Reexecution failed\",\n        description: \"Failed to reexecute automation\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const formatDate = (date: Date) => {\n    return new Intl.DateTimeFormat(\"en-US\", {\n      month: \"short\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    }).format(new Date(date));\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex h-full items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  const history = data?.history || [];\n\n  return (\n    <div className=\"flex h-full gap-4 p-4\">\n      <div className=\"flex-1 flex flex-col gap-4\">\n        <div className=\"flex items-center justify-between\">\n          <h1 className=\"text-2xl font-bold\">Automation History</h1>\n          {history.length > 0 && (\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button variant=\"destructive\" size=\"sm\" data-testid=\"button-delete-all\">\n                  <Trash2 className=\"h-4 w-4 mr-2\" />\n                  Clear All\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Clear all history?</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    This will permanently delete all {history.length} automation history items. This action cannot be undone.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel data-testid=\"button-cancel-delete-all\">Cancel</AlertDialogCancel>\n                  <AlertDialogAction\n                    onClick={() => deleteAllMutation.mutate()}\n                    className=\"bg-destructive hover:bg-destructive/90\"\n                    data-testid=\"button-confirm-delete-all\"\n                  >\n                    Delete All\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          )}\n        </div>\n\n        {history.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center h-64\">\n              <AlertCircle className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <p className=\"text-lg font-medium text-muted-foreground\">No history yet</p>\n              <p className=\"text-sm text-muted-foreground\">Your automation history will appear here</p>\n            </CardContent>\n          </Card>\n        ) : (\n          <ScrollArea className=\"flex-1\">\n            <div className=\"space-y-4\">\n              {history.map((item) => (\n                <Card\n                  key={item.id}\n                  className={`cursor-pointer transition-colors hover-elevate ${\n                    selectedHistory?.id === item.id ? \"ring-2 ring-primary\" : \"\"\n                  }`}\n                  onClick={() => setSelectedHistory(item)}\n                  data-testid={`history-item-${item.id}`}\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex-1 min-w-0\">\n                        <CardTitle className=\"text-base truncate\">{item.prompt}</CardTitle>\n                        <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n                          <Badge variant={item.success ? \"default\" : \"destructive\"} className=\"text-xs\">\n                            {item.success ? <Check className=\"h-3 w-3 mr-1\" /> : <X className=\"h-3 w-3 mr-1\" />}\n                            {item.success ? \"Success\" : \"Failed\"}\n                          </Badge>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {item.mode}\n                          </Badge>\n                          <span className=\"text-xs text-muted-foreground\">\n                            {formatDate(item.createdAt)}\n                          </span>\n                        </div>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            reexecuteMutation.mutate(item.id);\n                          }}\n                          disabled={reexecuteMutation.isPending}\n                          data-testid={`button-reexecute-${item.id}`}\n                        >\n                          <RotateCcw className=\"h-4 w-4\" />\n                        </Button>\n                        <AlertDialog>\n                          <AlertDialogTrigger asChild onClick={(e) => e.stopPropagation()}>\n                            <Button\n                              size=\"icon\"\n                              variant=\"ghost\"\n                              data-testid={`button-delete-${item.id}`}\n                            >\n                              <Trash2 className=\"h-4 w-4\" />\n                            </Button>\n                          </AlertDialogTrigger>\n                          <AlertDialogContent>\n                            <AlertDialogHeader>\n                              <AlertDialogTitle>Delete this history item?</AlertDialogTitle>\n                              <AlertDialogDescription>\n                                This action cannot be undone.\n                              </AlertDialogDescription>\n                            </AlertDialogHeader>\n                            <AlertDialogFooter>\n                              <AlertDialogCancel data-testid={`button-cancel-delete-${item.id}`}>Cancel</AlertDialogCancel>\n                              <AlertDialogAction\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  deleteMutation.mutate(item.id);\n                                  if (selectedHistory?.id === item.id) {\n                                    setSelectedHistory(null);\n                                  }\n                                }}\n                                className=\"bg-destructive hover:bg-destructive/90\"\n                                data-testid={`button-confirm-delete-${item.id}`}\n                              >\n                                Delete\n                              </AlertDialogAction>\n                            </AlertDialogFooter>\n                          </AlertDialogContent>\n                        </AlertDialog>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  {item.detectedUrl && (\n                    <CardContent className=\"pt-0\">\n                      <p className=\"text-sm text-muted-foreground truncate\">{item.detectedUrl}</p>\n                    </CardContent>\n                  )}\n                </Card>\n              ))}\n            </div>\n          </ScrollArea>\n        )}\n      </div>\n\n      <div className=\"w-96\">\n        {selectedHistory ? (\n          <Card className=\"h-full flex flex-col\">\n            <CardHeader>\n              <CardTitle className=\"text-base\">Details</CardTitle>\n            </CardHeader>\n            <CardContent className=\"flex-1 flex flex-col gap-4 overflow-hidden\">\n              {selectedHistory.screenshot && (\n                <div>\n                  <p className=\"text-sm font-medium mb-2\">Screenshot</p>\n                  <img\n                    src={selectedHistory.screenshot}\n                    alt=\"Automation screenshot\"\n                    className=\"w-full rounded-md border\"\n                    data-testid={`screenshot-${selectedHistory.id}`}\n                  />\n                </div>\n              )}\n              <div>\n                <p className=\"text-sm font-medium mb-2\">Execution Logs</p>\n                <ScrollArea className=\"h-64 border rounded-md p-3\">\n                  <div className=\"space-y-2\">\n                    {selectedHistory.logs.map((log) => (\n                      <div key={log.id} className=\"text-xs\" data-testid={`log-${log.id}`}>\n                        <Badge\n                          variant={\n                            log.status === \"success\"\n                              ? \"default\"\n                              : log.status === \"error\"\n                              ? \"destructive\"\n                              : \"secondary\"\n                          }\n                          className=\"text-xs mb-1\"\n                        >\n                          {log.status}\n                        </Badge>\n                        <p className=\"text-muted-foreground\">{log.action}</p>\n                        {log.description && (\n                          <p className=\"text-muted-foreground mt-1 pl-2 border-l-2\">\n                            {log.description}\n                          </p>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                </ScrollArea>\n              </div>\n              {selectedHistory.generatedCode.locators && (\n                <div>\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <p className=\"text-sm font-medium\">Generated Code</p>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => {\n                        navigator.clipboard.writeText(selectedHistory.generatedCode.locators || '');\n                        toast({\n                          title: \"Copied to clipboard\",\n                          description: \"Code copied successfully\",\n                        });\n                      }}\n                      data-testid={`button-copy-code-${selectedHistory.id}`}\n                    >\n                      Copy\n                    </Button>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mb-2\">\n                    Rerunnable code with locators (no LLM calls)\n                  </p>\n                  <ScrollArea className=\"h-96 border rounded-md\">\n                    <pre className=\"p-3 text-xs font-mono\">\n                      <code data-testid={`code-${selectedHistory.id}`}>\n                        {selectedHistory.generatedCode.locators}\n                      </code>\n                    </pre>\n                  </ScrollArea>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ) : (\n          <Card className=\"h-full flex items-center justify-center\">\n            <CardContent className=\"text-center\">\n              <p className=\"text-muted-foreground\">Select a history item to view details</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":13780},"server/index.ts":{"content":"import \"dotenv/config\";\nimport express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n\n  // Use 0.0.0.0 for Replit environment to allow external connections\n  const host = '0.0.0.0';\n\n  // Use the traditional listen signature for better Windows compatibility\n  server.listen(port, host, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2360},"shared/schema.ts":{"content":"import { z } from \"zod\";\nimport { pgTable, text, timestamp, jsonb, vector, serial, boolean } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { sql } from \"drizzle-orm\";\n\n// Automation request schema\nexport const automationModeSchema = z.enum([\"act\", \"observe\", \"extract\", \"agent\"]);\nexport type AutomationMode = z.infer<typeof automationModeSchema>;\n\n// Unified automation request - system auto-detects URL and appropriate mode\nexport const unifiedAutomationRequestSchema = z.object({\n  prompt: z.string().min(1), // Natural language prompt including URL and task\n  model: z.string().default(\"google/gemini-2.5-flash\"),\n});\nexport type UnifiedAutomationRequest = z.infer<typeof unifiedAutomationRequestSchema>;\n\n// Legacy automation request (for backward compatibility)\nexport const automationRequestSchema = z.object({\n  url: z.string().url(),\n  prompt: z.string().min(1),\n  mode: automationModeSchema,\n  model: z.string().default(\"google/gemini-2.5-flash\"),\n});\nexport type AutomationRequest = z.infer<typeof automationRequestSchema>;\n\n// Log entry schema\nexport const logEntryStatusSchema = z.enum([\"success\", \"error\", \"pending\", \"running\"]);\nexport type LogEntryStatus = z.infer<typeof logEntryStatusSchema>;\n\nexport const logEntrySchema = z.object({\n  id: z.string(),\n  timestamp: z.number(),\n  action: z.string(),\n  status: logEntryStatusSchema,\n  selector: z.string().optional(),\n  description: z.string().optional(),\n});\nexport type LogEntry = z.infer<typeof logEntrySchema>;\n\n// Automation response schema\nexport const automationResponseSchema = z.object({\n  success: z.boolean(),\n  sessionId: z.string(),\n  logs: z.array(logEntrySchema),\n  generatedCode: z.object({\n    typescript: z.string().optional(), // LLM-based code (act/observe/extract)\n    cached: z.string().optional(), // Code with caching enabled\n    agent: z.string().optional(), // Agent-based code\n    locators: z.string().optional(), // Rerunnable code with locators/deepLocators\n  }),\n  error: z.string().optional(),\n  detectedUrl: z.string().optional(), // Auto-detected URL from prompt\n  usedModes: z.array(automationModeSchema).optional(), // Which modes were used\n  screenshot: z.string().optional(), // Base64 encoded screenshot\n});\nexport type AutomationResponse = z.infer<typeof automationResponseSchema>;\n\n// WebSocket message types\nexport const wsLogMessageSchema = z.object({\n  type: z.literal(\"log\"),\n  sessionId: z.string(),\n  log: logEntrySchema,\n});\n\nexport const wsCompleteMessageSchema = z.object({\n  type: z.literal(\"complete\"),\n  sessionId: z.string(),\n  response: automationResponseSchema,\n});\n\nexport const wsErrorMessageSchema = z.object({\n  type: z.literal(\"error\"),\n  sessionId: z.string(),\n  error: z.string(),\n});\n\nexport const wsMessageSchema = z.union([\n  wsLogMessageSchema,\n  wsCompleteMessageSchema,\n  wsErrorMessageSchema,\n]);\n\nexport type WSMessage = z.infer<typeof wsMessageSchema>;\n\n// Database schema for automation history with semantic caching\nexport const automationHistory = pgTable(\"automation_history\", {\n  id: serial(\"id\").primaryKey(),\n  prompt: text(\"prompt\").notNull(),\n  promptEmbedding: vector(\"prompt_embedding\", { dimensions: 1536 }), // OpenAI text-embedding-3-small uses 1536 dimensions\n  detectedUrl: text(\"detected_url\"),\n  mode: text(\"mode\").notNull(),\n  model: text(\"model\").notNull(),\n  success: boolean(\"success\").notNull(),\n  sessionId: text(\"session_id\").notNull(),\n  logs: jsonb(\"logs\").$type<LogEntry[]>().notNull(),\n  generatedCode: jsonb(\"generated_code\").$type<{\n    typescript?: string;\n    cached?: string;\n    agent?: string;\n    locators?: string;\n  }>().notNull(),\n  screenshot: text(\"screenshot\"), // Base64 encoded screenshot\n  error: text(\"error\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertAutomationHistorySchema = createInsertSchema(automationHistory).omit({\n  id: true,\n  createdAt: true,\n  promptEmbedding: true,\n});\n\nexport type InsertAutomationHistory = z.infer<typeof insertAutomationHistorySchema>;\nexport type AutomationHistory = typeof automationHistory.$inferSelect;\nexport type AutomationHistoryInsert = typeof automationHistory.$inferInsert;\n","size_bytes":4185},"client/src/components/examples/BrowserPreview.tsx":{"content":"import BrowserPreview from \"../BrowserPreview\";\n\nexport default function BrowserPreviewExample() {\n  return (\n    <div className=\"h-96\">\n      <BrowserPreview\n        isLoading={false}\n        currentUrl=\"https://example.com\"\n      />\n    </div>\n  );\n}\n","size_bytes":253},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"start-servers.sh":{"content":"#!/bin/bash\n\n# Start Python API server in background\necho \"Starting Python API server on port 8000...\"\npython -m uvicorn server.main:app --host 0.0.0.0 --port 8000 &\nPYTHON_PID=$!\n\n# Wait a bit for Python server to start\nsleep 2\n\n# Start Node.js server (foreground - this is the main process)\necho \"Starting Node.js server on port 5000...\"\nNODE_ENV=development npm run dev\n\n# If Node.js exits, kill Python server\nkill $PYTHON_PID\n","size_bytes":430},"client/src/components/AutomationInput.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Play, Settings } from \"lucide-react\";\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"@/components/ui/collapsible\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\ntype AutomationMode = \"act\" | \"observe\" | \"extract\" | \"agent\";\n\ninterface AutomationInputProps {\n  onExecute: (data: {\n    url: string;\n    prompt: string;\n    mode: AutomationMode;\n    model?: string;\n  }) => void;\n  isExecuting?: boolean;\n}\n\nexport default function AutomationInput({ onExecute, isExecuting = false }: AutomationInputProps) {\n  const [url, setUrl] = useState(\"https://\");\n  const [prompt, setPrompt] = useState(\"\");\n  const [mode, setMode] = useState<AutomationMode>(\"act\");\n  const [model, setModel] = useState(\"google/gemini-2.5-flash\");\n  const [isConfigOpen, setIsConfigOpen] = useState(false);\n\n  const handleExecute = () => {\n    if (url && prompt) {\n      onExecute({ url, prompt, mode, model });\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col gap-6\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"url\" className=\"text-sm font-medium\">\n          Target URL\n        </Label>\n        <Input\n          id=\"url\"\n          data-testid=\"input-url\"\n          type=\"url\"\n          placeholder=\"https://example.com\"\n          value={url}\n          onChange={(e) => setUrl(e.target.value)}\n          className=\"h-12 font-mono text-sm\"\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"prompt\" className=\"text-sm font-medium\">\n          Natural Language Prompt\n        </Label>\n        <Textarea\n          id=\"prompt\"\n          data-testid=\"input-prompt\"\n          placeholder=\"Describe what you want to automate... (e.g., 'Click the login button and fill the form')\"\n          value={prompt}\n          onChange={(e) => setPrompt(e.target.value)}\n          className=\"min-h-24 resize-none font-sans\"\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label className=\"text-sm font-medium\">Automation Mode</Label>\n        <RadioGroup\n          value={mode}\n          onValueChange={(value) => setMode(value as AutomationMode)}\n          className=\"grid grid-cols-4 gap-4\"\n        >\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"act\" id=\"mode-act\" data-testid=\"radio-act\" />\n            <Label htmlFor=\"mode-act\" className=\"cursor-pointer font-normal\">\n              Act\n            </Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"observe\" id=\"mode-observe\" data-testid=\"radio-observe\" />\n            <Label htmlFor=\"mode-observe\" className=\"cursor-pointer font-normal\">\n              Observe\n            </Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"extract\" id=\"mode-extract\" data-testid=\"radio-extract\" />\n            <Label htmlFor=\"mode-extract\" className=\"cursor-pointer font-normal\">\n              Extract\n            </Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"agent\" id=\"mode-agent\" data-testid=\"radio-agent\" />\n            <Label htmlFor=\"mode-agent\" className=\"cursor-pointer font-normal\">\n              Agent\n            </Label>\n          </div>\n        </RadioGroup>\n      </div>\n\n      <Collapsible open={isConfigOpen} onOpenChange={setIsConfigOpen}>\n        <CollapsibleTrigger asChild>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"w-full justify-start gap-2\"\n            data-testid=\"button-config-toggle\"\n          >\n            <Settings className=\"h-4 w-4\" />\n            Advanced Configuration\n          </Button>\n        </CollapsibleTrigger>\n        <CollapsibleContent className=\"space-y-4 pt-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"model\" className=\"text-sm font-medium\">\n              Model\n            </Label>\n            <Select value={model} onValueChange={setModel}>\n              <SelectTrigger id=\"model\" data-testid=\"select-model\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"google/gemini-2.5-flash\">Google Gemini 2.5 Flash</SelectItem>\n                <SelectItem value=\"google/gemini-2.5-pro\">Google Gemini 2.5 Pro</SelectItem>\n                <SelectItem value=\"anthropic/claude-sonnet-4-20250514\">Anthropic Claude Sonnet 4</SelectItem>\n                <SelectItem value=\"openai/gpt-4o\">OpenAI GPT-4o</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </CollapsibleContent>\n      </Collapsible>\n\n      <Button\n        onClick={handleExecute}\n        disabled={!url || !prompt || isExecuting}\n        className=\"h-10 w-full gap-2\"\n        data-testid=\"button-execute\"\n      >\n        <Play className=\"h-4 w-4\" />\n        {isExecuting ? \"Executing...\" : \"Execute Automation\"}\n      </Button>\n    </div>\n  );\n}\n","size_bytes":5361},"client/src/components/BrowserPreview.tsx":{"content":"import { Card } from \"@/components/ui/card\";\nimport { Loader2 } from \"lucide-react\";\n\ninterface BrowserPreviewProps {\n  isLoading?: boolean;\n  currentUrl?: string;\n}\n\nexport default function BrowserPreview({ isLoading = false, currentUrl }: BrowserPreviewProps) {\n  return (\n    <Card className=\"flex h-full flex-col overflow-hidden border\">\n      <div className=\"flex h-10 items-center gap-2 border-b bg-muted/30 px-4\">\n        <div className=\"flex gap-1.5\">\n          <div className=\"h-3 w-3 rounded-full bg-destructive/60\" />\n          <div className=\"h-3 w-3 rounded-full bg-yellow-500/60\" />\n          <div className=\"h-3 w-3 rounded-full bg-green-500/60\" />\n        </div>\n        {currentUrl && (\n          <div className=\"ml-4 flex-1 truncate font-mono text-xs text-muted-foreground\">\n            {currentUrl}\n          </div>\n        )}\n      </div>\n      <div className=\"relative flex flex-1 items-center justify-center bg-background\">\n        {isLoading ? (\n          <div className=\"flex flex-col items-center gap-3\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n            <p className=\"text-sm text-muted-foreground\">Loading browser session...</p>\n          </div>\n        ) : (\n          <div className=\"flex flex-col items-center gap-2 text-center\">\n            <div className=\"text-6xl text-muted-foreground/20\">🌐</div>\n            <p className=\"text-sm text-muted-foreground\">\n              Browser preview will appear here\n            </p>\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n}\n","size_bytes":1557},"client/src/components/examples/Header.tsx":{"content":"import Header from \"../Header\";\n\nexport default function HeaderExample() {\n  return (\n    <Header\n      sessionId=\"abc-123-def\"\n      status=\"running\"\n    />\n  );\n}\n","size_bytes":165},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/neon-serverless\";\nimport { Pool, neonConfig } from \"@neondatabase/serverless\";\nimport * as schema from \"@shared/schema\";\nimport ws from \"ws\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL is not set\");\n}\n\nneonConfig.webSocketConstructor = ws;\n\nconst pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n","size_bytes":417},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"server/api-client.ts":{"content":"const PYTHON_API_URL = process.env.PYTHON_API_URL || \"http://localhost:8000\";\n\ninterface ApiHistory {\n  id: number;\n  prompt: string;\n  promptEmbedding: number[] | null;\n  detectedUrl: string | null;\n  mode: string;\n  model: string;\n  success: boolean;\n  sessionId: string;\n  logs: any[];\n  generatedCode: {\n    typescript?: string;\n    cached?: string;\n    agent?: string;\n    locators?: string;\n  };\n  screenshot: string | null;\n  error: string | null;\n  createdAt: string;\n}\n\nexport async function fetchAllHistory(): Promise<ApiHistory[]> {\n  const response = await fetch(`${PYTHON_API_URL}/api/history`);\n  if (!response.ok) {\n    throw new Error(`Failed to fetch history: ${response.statusText}`);\n  }\n  return response.json();\n}\n\nexport async function fetchHistoryById(id: number): Promise<ApiHistory> {\n  const response = await fetch(`${PYTHON_API_URL}/api/history/${id}`);\n  if (!response.ok) {\n    throw new Error(`Failed to fetch history: ${response.statusText}`);\n  }\n  return response.json();\n}\n\nexport async function createHistory(data: {\n  prompt: string;\n  prompt_embedding: number[] | null;\n  detected_url: string | null;\n  mode: string;\n  model: string;\n  success: boolean;\n  session_id: string;\n  logs: any[];\n  generated_code: any;\n  screenshot: string | null;\n  error: string | null;\n}): Promise<{ id: number; message: string }> {\n  const response = await fetch(`${PYTHON_API_URL}/api/history`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(data),\n  });\n  \n  if (!response.ok) {\n    throw new Error(`Failed to create history: ${response.statusText}`);\n  }\n  return response.json();\n}\n\nexport async function deleteHistory(id: number): Promise<{ message: string }> {\n  const response = await fetch(`${PYTHON_API_URL}/api/history/${id}`, {\n    method: \"DELETE\",\n  });\n  \n  if (!response.ok) {\n    throw new Error(`Failed to delete history: ${response.statusText}`);\n  }\n  return response.json();\n}\n\nexport async function deleteAllHistory(): Promise<{ message: string }> {\n  const response = await fetch(`${PYTHON_API_URL}/api/history`, {\n    method: \"DELETE\",\n  });\n  \n  if (!response.ok) {\n    throw new Error(`Failed to delete all history: ${response.statusText}`);\n  }\n  return response.json();\n}\n\nexport async function fetchCache(): Promise<ApiHistory[]> {\n  const response = await fetch(`${PYTHON_API_URL}/api/cache`);\n  if (!response.ok) {\n    throw new Error(`Failed to fetch cache: ${response.statusText}`);\n  }\n  return response.json();\n}\n\nexport async function findSimilar(\n  embedding: number[],\n  threshold: number = 0.85,\n  limit: number = 10\n): Promise<(ApiHistory & { similarity: number })[]> {\n  const response = await fetch(`${PYTHON_API_URL}/api/similarity-search`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ embedding, threshold, limit }),\n  });\n  \n  if (!response.ok) {\n    throw new Error(`Failed to search similar: ${response.statusText}`);\n  }\n  return response.json();\n}\n","size_bytes":3025},"client/src/components/Header.tsx":{"content":"import { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Code2, Moon, Sun, Settings } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { Link } from \"wouter\";\n\ninterface HeaderProps {\n  sessionId?: string;\n  status?: \"idle\" | \"running\" | \"completed\" | \"error\";\n  isConnected?: boolean;\n}\n\nexport default function Header({ sessionId, status = \"idle\", isConnected = false }: HeaderProps) {\n  const [theme, setTheme] = useState<\"light\" | \"dark\">(\"light\");\n\n  useEffect(() => {\n    const isDark = document.documentElement.classList.contains(\"dark\");\n    setTheme(isDark ? \"dark\" : \"light\");\n  }, []);\n\n  const toggleTheme = () => {\n    const newTheme = theme === \"light\" ? \"dark\" : \"light\";\n    setTheme(newTheme);\n    document.documentElement.classList.toggle(\"dark\");\n  };\n\n  const statusConfig = {\n    idle: { label: \"Idle\", className: \"bg-muted text-muted-foreground border-muted-foreground/20\" },\n    running: { label: \"Running\", className: \"bg-primary/10 text-primary border-primary/20\" },\n    completed: { label: \"Completed\", className: \"bg-green-500/10 text-green-500 border-green-500/20\" },\n    error: { label: \"Error\", className: \"bg-destructive/10 text-destructive border-destructive/20\" },\n  };\n\n  return (\n    <header className=\"sticky top-0 z-50 flex h-16 items-center justify-between border-b bg-background px-6\">\n      <div className=\"flex items-center gap-3\">\n        <Code2 className=\"h-6 w-6 text-primary\" />\n        <div>\n          <h1 className=\"text-lg font-semibold\">VisionVault</h1>\n          <p className=\"text-xs text-muted-foreground\">AI Powered</p>\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-4\">\n        {isConnected && (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"h-2 w-2 rounded-full bg-green-500 animate-pulse\" />\n            <span className=\"text-xs text-muted-foreground\">Live</span>\n          </div>\n        )}\n        {sessionId && (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-xs text-muted-foreground\">Session:</span>\n            <code className=\"rounded bg-muted px-2 py-1 font-mono text-xs\">{sessionId}</code>\n          </div>\n        )}\n        <Badge variant=\"outline\" className={statusConfig[status].className} data-testid={`status-${status}`}>\n          {statusConfig[status].label}\n        </Badge>\n        <Link href=\"/settings\">\n          <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-settings\">\n            <Settings className=\"h-5 w-5\" />\n          </Button>\n        </Link>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={toggleTheme}\n          data-testid=\"button-theme-toggle\"\n        >\n          {theme === \"light\" ? <Moon className=\"h-5 w-5\" /> : <Sun className=\"h-5 w-5\" />}\n        </Button>\n      </div>\n    </header>\n  );\n}\n","size_bytes":2904},"client/src/components/examples/ExecutionLog.tsx":{"content":"import ExecutionLog, { LogEntry } from \"../ExecutionLog\";\n\nexport default function ExecutionLogExample() {\n  const sampleEntries: LogEntry[] = [\n    {\n      id: \"1\",\n      timestamp: Date.now() - 5000,\n      action: \"Navigate to URL\",\n      status: \"success\",\n      description: \"Loaded https://example.com\",\n    },\n    {\n      id: \"2\",\n      timestamp: Date.now() - 3000,\n      action: \"Observe elements\",\n      status: \"success\",\n      selector: \"xpath=/html/body/div[1]/button[1]\",\n      description: \"Found login button\",\n    },\n    {\n      id: \"3\",\n      timestamp: Date.now() - 1000,\n      action: \"Click element\",\n      status: \"running\",\n      selector: \"xpath=/html/body/div[1]/button[1]\",\n      description: \"Clicking login button\",\n    },\n  ];\n\n  return (\n    <div className=\"h-96\">\n      <ExecutionLog entries={sampleEntries} />\n    </div>\n  );\n}\n","size_bytes":859},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"SETUP.md":{"content":"# Stagehand Automation Studio - Setup Guide\n\n## Prerequisites\n\n- Node.js 20+ installed\n- Chrome/Chromium browser installed on your system\n\n## Installation\n\n1. **Install dependencies:**\n   ```bash\n   npm install\n   ```\n\n2. **Install Playwright browsers:**\n   ```bash\n   npx playwright install chromium\n   ```\n\n3. **Set up environment variables:**\n   \n   Copy the example file:\n   ```bash\n   cp .env.example .env\n   ```\n   \n   Then edit `.env` and add your API key. **Choose one based on which AI model you want to use:**\n\n   **For Google Gemini (recommended for beginners):**\n   - Get your API key from: https://aistudio.google.com/app/apikey\n   - Add to `.env`:\n     ```\n     GOOGLE_GENERATIVE_AI_API_KEY=your_actual_key_here\n     ```\n\n   **For OpenAI (GPT models):**\n   - Get your API key from: https://platform.openai.com/api-keys\n   - Add to `.env`:\n     ```\n     OPENAI_API_KEY=your_actual_key_here\n     ```\n\n   **For Anthropic (Claude models):**\n   - Get your API key from: https://console.anthropic.com/\n   - Add to `.env`:\n     ```\n     ANTHROPIC_API_KEY=your_actual_key_here\n     ```\n\n## Running the Application\n\n**Development mode (with hot reload):**\n```bash\nnpm run dev\n```\n\nThe app will start on http://localhost:5000\n\n**When you execute an automation:**\n- A visible Chrome browser window will open on your screen\n- You can watch the automation happen in real-time\n- The execution log and generated code appear in the UI\n\n## Available Models\n\nYou can select different models in the Advanced Configuration section of the UI:\n\n- `google/gemini-2.5-flash` (default, fast and cheap)\n- `google/gemini-2.5-pro` (more powerful)\n- `openai/gpt-4.1-mini` (requires OpenAI key)\n- `anthropic/claude-3.7-sonnet` (requires Anthropic key)\n\n## Automation Modes\n\n- **Act**: Execute single actions (\"Click the login button\")\n- **Observe**: Discover available elements and actions on a page\n- **Extract**: Pull structured data from pages using natural language\n- **Agent**: Autonomous multi-step workflows\n\n## Troubleshooting\n\n**Error: \"API key not found\"**\n- Make sure you created the `.env` file from `.env.example`\n- Check that the API key matches the model provider you're using\n\n**Error: \"Executable doesn't exist\"**\n- Run `npx playwright install chromium`\n\n**Browser doesn't open:**\n- Check that Chrome/Chromium is installed on your system\n- Make sure `headless: false` is set in `server/routes.ts`\n\n## Cloud Alternative (BrowserBase)\n\nIf you want to use cloud browsers instead of local:\n\n1. Sign up at https://browserbase.com\n2. Get your API key and project ID\n3. Add to `.env`:\n   ```\n   BROWSERBASE_API_KEY=your_key\n   BROWSERBASE_PROJECT_ID=your_project_id\n   ```\n4. Change `env: \"BROWSERBASE\"` in `server/routes.ts`\n","size_bytes":2720},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/CodeOutput.tsx":{"content":"import { useState } from \"react\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Copy, Download, Check } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface CodeOutputProps {\n  typescriptCode?: string;\n  cachedCode?: string;\n  agentCode?: string;\n}\n\nexport default function CodeOutput({ typescriptCode, cachedCode, agentCode }: CodeOutputProps) {\n  const [copied, setCopied] = useState(false);\n  const { toast } = useToast();\n\n  const handleCopy = (code: string) => {\n    navigator.clipboard.writeText(code);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n    toast({\n      title: \"Copied to clipboard\",\n      description: \"Code has been copied to your clipboard\",\n    });\n  };\n\n  const handleDownload = (code: string, filename: string) => {\n    const blob = new Blob([code], { type: \"text/plain\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = filename;\n    a.click();\n    URL.revokeObjectURL(url);\n    toast({\n      title: \"Downloaded\",\n      description: `${filename} has been downloaded`,\n    });\n  };\n\n  const hasCode = typescriptCode || cachedCode || agentCode;\n\n  return (\n    <Card className=\"flex h-full flex-col overflow-hidden border\">\n      <div className=\"flex h-10 items-center justify-between border-b px-4\">\n        <h3 className=\"text-sm font-medium\">Generated Code</h3>\n        {hasCode && (\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => handleCopy(typescriptCode || cachedCode || agentCode || \"\")}\n              data-testid=\"button-copy-code\"\n            >\n              {copied ? (\n                <Check className=\"h-4 w-4\" />\n              ) : (\n                <Copy className=\"h-4 w-4\" />\n              )}\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => handleDownload(typescriptCode || \"\", \"automation.ts\")}\n              data-testid=\"button-download-code\"\n            >\n              <Download className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        )}\n      </div>\n      <div className=\"flex-1 overflow-hidden\">\n        {!hasCode ? (\n          <div className=\"flex h-full items-center justify-center\">\n            <p className=\"text-sm text-muted-foreground\">\n              Generated code will appear here\n            </p>\n          </div>\n        ) : (\n          <Tabs defaultValue=\"typescript\" className=\"flex h-full flex-col\">\n            <TabsList className=\"mx-4 mt-2 w-auto\">\n              {typescriptCode && <TabsTrigger value=\"typescript\" data-testid=\"tab-typescript\">TypeScript</TabsTrigger>}\n              {cachedCode && <TabsTrigger value=\"cached\" data-testid=\"tab-cached\">Cached</TabsTrigger>}\n              {agentCode && <TabsTrigger value=\"agent\" data-testid=\"tab-agent\">Agent</TabsTrigger>}\n            </TabsList>\n            <div className=\"flex-1 overflow-auto\">\n              {typescriptCode && (\n                <TabsContent value=\"typescript\" className=\"m-0 h-full\">\n                  <pre className=\"h-full overflow-auto bg-neutral-900 p-4 font-mono text-sm text-neutral-100\">\n                    <code>{typescriptCode}</code>\n                  </pre>\n                </TabsContent>\n              )}\n              {cachedCode && (\n                <TabsContent value=\"cached\" className=\"m-0 h-full\">\n                  <pre className=\"h-full overflow-auto bg-neutral-900 p-4 font-mono text-sm text-neutral-100\">\n                    <code>{cachedCode}</code>\n                  </pre>\n                </TabsContent>\n              )}\n              {agentCode && (\n                <TabsContent value=\"agent\" className=\"m-0 h-full\">\n                  <pre className=\"h-full overflow-auto bg-neutral-900 p-4 font-mono text-sm text-neutral-100\">\n                    <code>{agentCode}</code>\n                  </pre>\n                </TabsContent>\n              )}\n            </div>\n          </Tabs>\n        )}\n      </div>\n    </Card>\n  );\n}\n","size_bytes":4231},"server/database.py":{"content":"from sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker, Session\nfrom server.models import Base\nimport os\n\nSQLITE_DATABASE_URL = os.getenv(\"SQLITE_DATABASE_URL\", \"sqlite:///./visionvault.db\")\n\nengine = create_engine(\n    SQLITE_DATABASE_URL,\n    connect_args={\"check_same_thread\": False},\n    echo=False\n)\n\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\n\ndef init_db():\n    Base.metadata.create_all(bind=engine)\n\ndef get_db():\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n","size_bytes":559},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/contexts/SettingsContext.tsx":{"content":"import { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\n\nexport type ScreenshotMode = \"every-step\" | \"last-step\" | \"none\";\n\ninterface SettingsContextType {\n  model: string;\n  setModel: (model: string) => void;\n  screenshotMode: ScreenshotMode;\n  setScreenshotMode: (mode: ScreenshotMode) => void;\n}\n\nconst SettingsContext = createContext<SettingsContextType | undefined>(undefined);\n\nconst DEFAULT_MODEL = \"google/gemini-2.5-flash\";\nconst DEFAULT_SCREENSHOT_MODE: ScreenshotMode = \"last-step\";\n\nexport function SettingsProvider({ children }: { children: ReactNode }) {\n  const [model, setModelState] = useState<string>(DEFAULT_MODEL);\n  const [screenshotMode, setScreenshotModeState] = useState<ScreenshotMode>(DEFAULT_SCREENSHOT_MODE);\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      const savedModel = localStorage.getItem(\"stagehand-model\");\n      if (savedModel) {\n        setModelState(savedModel);\n      }\n      \n      const savedScreenshotMode = localStorage.getItem(\"stagehand-screenshot-mode\") as ScreenshotMode;\n      if (savedScreenshotMode && [\"every-step\", \"last-step\", \"none\"].includes(savedScreenshotMode)) {\n        setScreenshotModeState(savedScreenshotMode);\n      }\n      \n      setIsInitialized(true);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (isInitialized && typeof window !== \"undefined\") {\n      localStorage.setItem(\"stagehand-model\", model);\n    }\n  }, [model, isInitialized]);\n\n  useEffect(() => {\n    if (isInitialized && typeof window !== \"undefined\") {\n      localStorage.setItem(\"stagehand-screenshot-mode\", screenshotMode);\n    }\n  }, [screenshotMode, isInitialized]);\n\n  const setModel = (newModel: string) => {\n    setModelState(newModel);\n  };\n\n  const setScreenshotMode = (mode: ScreenshotMode) => {\n    setScreenshotModeState(mode);\n  };\n\n  return (\n    <SettingsContext.Provider value={{ model, setModel, screenshotMode, setScreenshotMode }}>\n      {children}\n    </SettingsContext.Provider>\n  );\n}\n\nexport function useSettings() {\n  const context = useContext(SettingsContext);\n  if (context === undefined) {\n    throw new Error(\"useSettings must be used within a SettingsProvider\");\n  }\n  return context;\n}\n","size_bytes":2258},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: '0.0.0.0',\n    port: 5000,\n    strictPort: true,\n    allowedHosts: ['all'],\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1166},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","size_bytes":96},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 0 0% 100%;\n  --foreground: 0 0% 9%;\n  --border: 0 0% 91%;\n  --card: 0 0% 98%;\n  --card-foreground: 0 0% 9%;\n  --card-border: 0 0% 94%;\n  --sidebar: 0 0% 96%;\n  --sidebar-foreground: 0 0% 9%;\n  --sidebar-border: 0 0% 92%;\n  --sidebar-primary: 217 91% 60%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 0 0% 92%;\n  --sidebar-accent-foreground: 0 0% 9%;\n  --sidebar-ring: 217 91% 60%;\n  --popover: 0 0% 94%;\n  --popover-foreground: 0 0% 9%;\n  --popover-border: 0 0% 90%;\n  --primary: 217 91% 60%;\n  --primary-foreground: 0 0% 100%;\n  --secondary: 0 0% 90%;\n  --secondary-foreground: 0 0% 9%;\n  --muted: 0 0% 93%;\n  --muted-foreground: 0 0% 40%;\n  --accent: 0 0% 94%;\n  --accent-foreground: 0 0% 9%;\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 0 0% 75%;\n  --ring: 217 91% 60%;\n  --chart-1: 217 91% 45%;\n  --chart-2: 173 58% 39%;\n  --chart-3: 197 37% 24%;\n  --chart-4: 43 74% 66%;\n  --chart-5: 27 87% 67%;\n  --font-sans: Inter, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: JetBrains Mono, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 0 0% 8%;\n  --foreground: 0 0% 96%;\n  --border: 0 0% 18%;\n  --card: 0 0% 10%;\n  --card-foreground: 0 0% 96%;\n  --card-border: 0 0% 14%;\n  --sidebar: 0 0% 12%;\n  --sidebar-foreground: 0 0% 96%;\n  --sidebar-border: 0 0% 16%;\n  --sidebar-primary: 217 91% 60%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 0 0% 16%;\n  --sidebar-accent-foreground: 0 0% 96%;\n  --sidebar-ring: 217 91% 60%;\n  --popover: 0 0% 14%;\n  --popover-foreground: 0 0% 96%;\n  --popover-border: 0 0% 18%;\n  --primary: 217 91% 60%;\n  --primary-foreground: 0 0% 100%;\n  --secondary: 0 0% 18%;\n  --secondary-foreground: 0 0% 96%;\n  --muted: 0 0% 16%;\n  --muted-foreground: 0 0% 60%;\n  --accent: 0 0% 14%;\n  --accent-foreground: 0 0% 96%;\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 0 0% 30%;\n  --ring: 217 91% 60%;\n  --chart-1: 217 91% 65%;\n  --chart-2: 173 58% 59%;\n  --chart-3: 197 37% 44%;\n  --chart-4: 43 74% 76%;\n  --chart-5: 27 87% 77%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","size_bytes":10535},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"fastapi>=0.121.1\",\n    \"numpy>=2.3.4\",\n    \"pydantic>=2.12.4\",\n    \"python-multipart>=0.0.20\",\n    \"sqlalchemy>=2.0.44\",\n    \"uvicorn>=0.38.0\",\n    \"websockets>=15.0.1\",\n]\n","size_bytes":319},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/app-sidebar.tsx":{"content":"import { Home, History, Database } from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n} from \"@/components/ui/sidebar\";\nimport { Link, useLocation } from \"wouter\";\n\nconst items = [\n  {\n    title: \"Home\",\n    url: \"/\",\n    icon: Home,\n  },\n  {\n    title: \"History\",\n    url: \"/history\",\n    icon: History,\n  },\n  {\n    title: \"Cache\",\n    url: \"/cache\",\n    icon: Database,\n  },\n];\n\nexport function AppSidebar() {\n  const [location] = useLocation();\n\n  return (\n    <Sidebar>\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>VisionVault</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {items.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild isActive={location === item.url}>\n                    <Link href={item.url} data-testid={`nav-${item.title.toLowerCase()}`}>\n                      <item.icon />\n                      <span>{item.title}</span>\n                    </Link>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n","size_bytes":1355},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"replit.md":{"content":"# Stagehand Automation Studio\n\n## Overview\n\nStagehand Automation Studio is a browser automation code generator that allows users to create web automation scripts using natural language prompts. The application features an intelligent unified interface where users describe their automation task in plain English, including the website URL and desired actions. The system automatically extracts the URL, analyzes the prompt, and selects the appropriate automation mode (act, observe, extract, or agent) based on the task description. It provides live execution logs via WebSocket streaming and generates production-ready TypeScript code. Its primary purpose is to bridge the gap between brittle selector-based automation and unpredictable AI agents, providing a developer-friendly tool that combines AI capabilities with code precision for web automation.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## Replit Environment Setup (November 13, 2025)\n\n### Configuration for Replit\n- **Server Binding**: Updated to bind to `0.0.0.0:5000` for Replit's proxy environment\n- **Vite Configuration**: Configured with `allowedHosts: ['all']` to work with Replit's iframe-based preview\n- **Workflow**: Configured `dev` workflow running `npm run dev` on port 5000 with webview output\n- **Deployment**: Set up as VM deployment (stateful) with build and start scripts\n- **Playwright Browsers**: Chromium browser installed for automation (headless mode)\n- **In-Memory Storage**: Using MemStorage class for current session (PostgreSQL not configured per user request)\n\n### Custom LLM Client Integration (November 13, 2025)\n- **Custom LLM Client Only**: Application exclusively uses custom LLM client, all Google/Gemini dependencies removed\n- **Dynamic Token Authentication**: API key is fetched dynamically via `fetch_token.py` script\n- **Token Caching**: Tokens are cached with automatic expiration and refresh (default 1 hour TTL)\n- **Flexible Configuration**: Supports any OpenAI-compatible API endpoint (Azure OpenAI, Ollama, custom deployments)\n- **Type Safety**: Fully compatible with Stagehand's LLMClient interface with proper TypeScript generics\n- **Response Parsing**: Intelligent response parsing for structured outputs and element/action normalization\n- **Environment Variables**:\n  - `CUSTOM_LLM_API_ENDPOINT`: The API endpoint URL for your custom LLM (required)\n  - `CUSTOM_LLM_MODEL_NAME`: The specific model name to use (default: `gpt-4o-1-2025-04-14-eastus-dz`)\n- **Token Fetching**: Customize `fetch_token.py` to implement your token fetching logic (OAuth, token service, etc.)\n- **Semantic Cache**: Disabled (previously used Google Gemini for embeddings)\n\n## Recent Changes (November 9, 2025)\n\n### Rerunnable Code Generation System ✅ COMPLETE\n- **Locator-based Code Generator**: Converts Stagehand automation steps into production-ready TypeScript code that can run without LLM inference\n- **XPath Preservation**: All selectors maintained as native Playwright XPath using `xpath=` prefix (no broken CSS conversion)\n- **Iframe Support**: Full support for nested iframes using `page.deepLocator()` with chained XPath segments\n- **String Safety**: Comprehensive escaping for all user inputs (URLs, prompts, selectors, values) preventing code injection\n- **Step Capture**: Intelligent step recording during execution, including fallback scenarios where selectors aren't available\n- **Database Storage**: Both LLM-generated code and rerunnable locator-based code stored in `automationHistory` table\n- **UI Display**: Generated scripts shown in Home page with syntax highlighting and copy functionality\n- **Code Generation Engine**: `server/locator-generator.ts` - Transforms captured steps into executable TypeScript using Stagehand's locator API\n\n### History and Cache Management System\n- **Screenshot Capture**: Automatically captures full-page screenshots before closing browser sessions using Playwright's `page.screenshot()` method\n- **Execution History**: Complete history of all automation runs with timestamps, prompts, models used, execution logs, and screenshots stored in PostgreSQL\n- **History Management**: Users can view, reexecute, and delete individual history items or clear all history through dedicated UI\n- **Semantic Cache Viewer**: View cached automation results with Gemini embeddings for intelligent prompt matching (0.85 similarity threshold)\n- **Sidebar Navigation**: Clean navigation between Home, History, and Cache pages using shadcn sidebar components\n- **API Endpoints**: \n  - `GET/DELETE /api/history` - List/clear all execution history\n  - `DELETE /api/history/:id` - Delete specific history item\n  - `POST /api/history/:id/reexecute` - Reexecute previous automation\n  - `GET /api/cache` - View semantic cache entries\n\n### Unified Natural Language Automation System\n- **Single Prompt Input**: Users now describe automation tasks in plain English without manually selecting modes or entering URLs separately\n- **Intelligent URL Extraction**: System automatically detects and extracts URLs from prompts (supports both full URLs and domain names)\n- **Smart Mode Selection**: Analyzes prompt keywords to automatically choose the best automation mode:\n  - `act` - For single click/type/scroll actions\n  - `observe` - For finding/locating elements\n  - `extract` - For data extraction and scraping\n  - `agent` - For multi-step workflows and complex tasks\n- **Live WebSocket Updates**: Real-time execution log streaming during automation runs\n- **Reconnection Resilience**: WebSocket automatically resubscribes to sessions after network interruptions, ensuring log continuity\n\n## System Architecture\n\n### Frontend Architecture\n\nThe frontend is built with React and TypeScript, bundled by Vite. It uses `wouter` for routing, `shadcn/ui` (built on Radix UI and styled with Tailwind CSS) for UI components, and `TanStack Query` for server state management. The design system incorporates Inter and JetBrains Mono fonts, a custom HSL-based color scheme for light/dark modes, and responsive layouts. Key pages include `Home` (automation input), `History` (execution history with screenshots), `Cache` (semantic cache viewer), and `Settings` (model configuration). Navigation is managed through a collapsible sidebar using shadcn's `Sidebar` components. The application uses a custom `useWebSocket` hook for managing real-time WebSocket connections with automatic reconnection and session resubscription.\n\n### Backend Architecture\n\nThe backend runs on Node.js with Express.js and TypeScript. It features both legacy (`/api/automate`) and unified (`/api/automate-unified`) REST endpoints for processing automation requests. The unified endpoint uses an intelligent router (`server/intelligent-router.ts`) to parse natural language prompts, extract URLs, and determine optimal automation modes. WebSocket support (`server/websocket.ts`) enables real-time log broadcasting to connected clients. The request flow involves Zod validation, prompt analysis, Stagehand browser automation initialization, step-by-step execution with live log streaming, and TypeScript code generation. The core automation engine is the `@browserbasehq/stagehand` library, supporting 'act', 'observe', 'extract', and 'agent' modes with local browser automation and configurable AI models.\n\n### Data Storage Solutions\n\nThe application uses an in-memory storage implementation (MemStorage class) for current operations. It is configured for PostgreSQL using `Drizzle ORM` and `@neondatabase/serverless` for production deployments, with schema definitions in `shared/schema.ts`. Data models include:\n- **automationHistory**: Stores execution history with prompt, mode, model, logs (JSONB), generated code, screenshots (base64), and Gemini embeddings (768-dimensional vectors via pgvector extension)\n- **User**: Basic user authentication schema\n- Screenshot storage uses base64-encoded data URIs stored in text fields for simplicity\n- Semantic caching leverages cosine similarity on Gemini embeddings with 0.85 threshold for intelligent prompt matching\n\n## External Dependencies\n\n- **Browser Automation**: `@browserbasehq/stagehand` (v2.5.0) for AI-powered browser control.\n- **Database & ORM**: `Drizzle ORM` (v0.39.1) for type-safe SQL, `Neon Database Serverless` for PostgreSQL connectivity.\n- **UI Framework**: `Radix UI` for accessible components, `Tailwind CSS` for styling, `shadcn/ui` for pre-built components.\n- **Form & Validation**: `React Hook Form` and `Zod` (with `drizzle-zod`) for form management and schema validation.\n- **API & State Management**: `TanStack React Query` (v5.60.5) for server state, `Express.js` for the web server.\n- **Development Tools**: `Vite` for development, `tsx` for TypeScript execution, `esbuild` for production bundling.\n- **Session Management**: `connect-pg-simple` for PostgreSQL session storage.\n- **AI Model Providers**: Google Gemini, OpenAI, Anthropic (via API keys).\n- **BrowserBase**: (Optional) `BROWSERBASE_API_KEY`, `BROWSERBASE_PROJECT_ID`.","size_bytes":9020},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"server/semantic-cache.ts":{"content":"import { type InsertAutomationHistory, type AutomationHistory } from \"@shared/schema\";\nimport { findSimilar, createHistory } from \"./api-client\";\nimport https from \"https\";\nimport { spawn } from \"child_process\";\n\nconst SIMILARITY_THRESHOLD = 0.85;\n\nasync function fetchOAuthToken(): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const pythonProcess = spawn(\"python\", [\"fetch_token.py\"]);\n    let output = \"\";\n    let errorOutput = \"\";\n    \n    pythonProcess.stdout.on(\"data\", (data) => {\n      output += data.toString();\n    });\n    \n    pythonProcess.stderr.on(\"data\", (data) => {\n      errorOutput += data.toString();\n    });\n    \n    pythonProcess.on(\"close\", (code) => {\n      if (code !== 0) {\n        reject(new Error(`Python script failed: ${errorOutput}`));\n      } else {\n        try {\n          const result = JSON.parse(output.trim());\n          if (result.error) {\n            reject(new Error(`OAuth error: ${result.error}`));\n          } else {\n            resolve(result.access_token);\n          }\n        } catch (e) {\n          reject(new Error(`Failed to parse OAuth response: ${output}`));\n        }\n      }\n    });\n  });\n}\n\nexport async function generateEmbedding(text: string): Promise<number[]> {\n  try {\n    const token = await fetchOAuthToken();\n    const embeddingEndpoint = process.env.OPENAI_EMBEDDING_ENDPOINT || \"https://api.openai.com/v1/embeddings\";\n    const embeddingModel = process.env.OPENAI_EMBEDDING_MODEL || \"text-embedding-3-small\";\n    \n    const requestPayload = {\n      input: text,\n      model: embeddingModel,\n      encoding_format: \"float\"\n    };\n    \n    const requestBody = JSON.stringify(requestPayload);\n    \n    return new Promise((resolve, reject) => {\n      const url = new URL(embeddingEndpoint);\n      \n      const options = {\n        hostname: url.hostname,\n        port: url.port || 443,\n        path: url.pathname,\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${token}`,\n          \"Content-Length\": Buffer.byteLength(requestBody),\n        },\n      };\n      \n      const req = https.request(options, (res) => {\n        let responseData = \"\";\n        \n        res.on(\"data\", (chunk) => {\n          responseData += chunk;\n        });\n        \n        res.on(\"end\", () => {\n          if (res.statusCode && res.statusCode >= 200 && res.statusCode < 300) {\n            try {\n              const data = JSON.parse(responseData);\n              const embedding = data.data?.[0]?.embedding;\n              \n              if (!embedding || !Array.isArray(embedding)) {\n                reject(new Error(\"Invalid embedding response\"));\n                return;\n              }\n              \n              resolve(embedding);\n            } catch (e) {\n              reject(new Error(`Failed to parse embedding response: ${responseData}`));\n            }\n          } else {\n            reject(new Error(`Embedding API request failed with status ${res.statusCode}: ${responseData}`));\n          }\n        });\n      });\n      \n      req.on(\"error\", (error) => {\n        reject(error);\n      });\n      \n      req.write(requestBody);\n      req.end();\n    });\n  } catch (error) {\n    console.error(\"Error generating embedding:\", error);\n    return [];\n  }\n}\n\nexport async function findSimilarAutomation(\n  prompt: string,\n  url?: string\n): Promise<{ automation: AutomationHistory; similarity: number } | null> {\n  try {\n    const embedding = await generateEmbedding(prompt);\n    \n    if (!embedding || embedding.length === 0) {\n      console.log(\"No embedding generated, skipping similarity search\");\n      return null;\n    }\n    \n    const results = await findSimilar(embedding, SIMILARITY_THRESHOLD, 10);\n    \n    if (results && results.length > 0) {\n      const topResult = results[0];\n      \n      if (topResult.similarity >= SIMILARITY_THRESHOLD) {\n        console.log(`Found similar automation with similarity: ${topResult.similarity}`);\n        \n        const automationHistory: AutomationHistory = {\n          id: topResult.id,\n          prompt: topResult.prompt,\n          promptEmbedding: topResult.promptEmbedding,\n          detectedUrl: topResult.detectedUrl,\n          mode: topResult.mode,\n          model: topResult.model,\n          success: topResult.success,\n          sessionId: topResult.sessionId,\n          logs: topResult.logs,\n          generatedCode: topResult.generatedCode,\n          screenshot: topResult.screenshot,\n          error: topResult.error,\n          createdAt: new Date(topResult.createdAt),\n        };\n        \n        return {\n          automation: automationHistory,\n          similarity: topResult.similarity\n        };\n      }\n    }\n    \n    return null;\n  } catch (error) {\n    console.error(\"Error finding similar automation:\", error);\n    return null;\n  }\n}\n\nexport async function saveAutomation(data: InsertAutomationHistory): Promise<void> {\n  try {\n    const embedding = await generateEmbedding(data.prompt);\n    \n    await createHistory({\n      prompt: data.prompt,\n      prompt_embedding: embedding.length > 0 ? embedding : null,\n      detected_url: data.detectedUrl ?? null,\n      mode: data.mode,\n      model: data.model,\n      success: data.success,\n      session_id: data.sessionId,\n      logs: data.logs,\n      generated_code: data.generatedCode,\n      screenshot: data.screenshot ?? null,\n      error: data.error ?? null,\n    });\n    \n    console.log(`Saved automation with embedding (${embedding.length} dimensions)`);\n  } catch (error) {\n    console.error(\"Error saving automation:\", error);\n    throw error;\n  }\n}\n","size_bytes":5609},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { Stagehand, type AvailableModel } from \"@browserbasehq/stagehand\";\nimport { z } from \"zod\";\nimport {\n  automationRequestSchema,\n  unifiedAutomationRequestSchema,\n  type AutomationResponse,\n  type LogEntry,\n  type AutomationMode\n} from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\nimport { setupWebSocket, broadcastToSession } from \"./websocket\";\nimport { parsePrompt, generateCodeForMode } from \"./intelligent-router\";\nimport { findSimilarAutomation, saveAutomation } from \"./semantic-cache\";\nimport { StagehandStep, emitLocatorScript, normalizeStep } from \"./locator-generator\";\nimport { CustomLLMClient } from \"./custom-llm-client\";\n\nfunction createStagehandInstance(modelName: string) {\n  const customClient = new CustomLLMClient({\n    modelName: modelName as AvailableModel,\n    apiEndpoint: process.env.CUSTOM_LLM_API_ENDPOINT!,\n    actualModelName: process.env.CUSTOM_LLM_MODEL_NAME || \"gpt-4o-1-2025-04-14-eastus-dz\",\n  });\n\n  return new Stagehand({\n    env: \"LOCAL\",\n    enableCaching: true,\n    localBrowserLaunchOptions: {\n      headless: false,\n    },\n    llmClient: customClient,\n  });\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  app.post(\"/api/automate\", async (req, res) => {\n    try {\n      const validatedData = automationRequestSchema.parse(req.body);\n      const sessionId = randomUUID();\n      const logs: LogEntry[] = [];\n\n      // Helper to add log entries\n      const addLog = (action: string, status: LogEntry[\"status\"], selector?: string, description?: string) => {\n        logs.push({\n          id: randomUUID(),\n          timestamp: Date.now(),\n          action,\n          status,\n          selector,\n          description,\n        });\n      };\n\n      addLog(\"Initializing browser session\", \"running\", undefined, `Using model: ${validatedData.model}`);\n\n      // Initialize Stagehand with custom or default LLM client\n      const stagehand = createStagehandInstance(validatedData.model);\n\n      try {\n        await stagehand.init();\n        addLog(\"Browser session initialized\", \"success\");\n\n        const page = stagehand.context.pages()[0];\n\n        // Navigate to URL\n        addLog(`Navigating to ${validatedData.url}`, \"running\");\n        await page.goto(validatedData.url, { waitUntil: \"networkidle\" });\n        addLog(`Loaded ${validatedData.url}`, \"success\");\n\n        let result: any;\n        let generatedCode = \"\";\n\n        // Execute based on mode\n        switch (validatedData.mode) {\n          case \"act\":\n            addLog(`Executing action: ${validatedData.prompt}`, \"running\");\n            result = await (stagehand as any).act(validatedData.prompt);\n            addLog(\"Action completed\", \"success\", undefined, \"Element interacted successfully\");\n\n            generatedCode = `import { Stagehand } from \"@browserbasehq/stagehand\";\n\nconst stagehand = new Stagehand({\n  env: \"LOCAL\",\n  modelName: \"${validatedData.model}\",\n  enableCaching: true\n});\n\nawait stagehand.init();\nconst page = stagehand.context.pages()[0];\n\nawait page.goto(\"${validatedData.url}\");\nawait stagehand.act(\"${validatedData.prompt}\");\n\nawait stagehand.close();`;\n            break;\n\n          case \"observe\":\n            addLog(`Observing: ${validatedData.prompt}`, \"running\");\n            result = await (stagehand as any).observe(validatedData.prompt);\n            addLog(\"Observation completed\", \"success\", undefined, JSON.stringify(result, null, 2));\n\n            generatedCode = `import { Stagehand } from \"@browserbasehq/stagehand\";\n\nconst stagehand = new Stagehand({\n  env: \"LOCAL\",\n  modelName: \"${validatedData.model}\",\n  enableCaching: true\n});\n\nawait stagehand.init();\nconst page = stagehand.context.pages()[0];\n\nawait page.goto(\"${validatedData.url}\");\nconst result = await stagehand.observe(\"${validatedData.prompt}\");\nconsole.log(\"Observed:\", result);\n\nawait stagehand.close();`;\n            break;\n\n          case \"extract\":\n            addLog(`Extracting: ${validatedData.prompt}`, \"running\");\n            // For extract, we need a schema - use a generic one for demo\n            const extractSchema = z.object({\n              data: z.string().describe(validatedData.prompt)\n            });\n            result = await (stagehand as any).extract(validatedData.prompt, extractSchema);\n            addLog(\"Extraction completed\", \"success\", undefined, JSON.stringify(result, null, 2));\n\n            generatedCode = `import { Stagehand } from \"@browserbasehq/stagehand\";\nimport { z } from \"zod\";\n\nconst stagehand = new Stagehand({\n  env: \"LOCAL\",\n  modelName: \"${validatedData.model}\",\n  enableCaching: true\n});\n\nawait stagehand.init();\nconst page = stagehand.context.pages()[0];\n\nawait page.goto(\"${validatedData.url}\");\n\nconst schema = z.object({\n  data: z.string().describe(\"${validatedData.prompt}\")\n});\n\nconst result = await stagehand.extract(\"${validatedData.prompt}\", schema);\nconsole.log(\"Extracted:\", result);\n\nawait stagehand.close();`;\n            break;\n\n          case \"agent\":\n            addLog(`Running agent: ${validatedData.prompt}`, \"running\");\n            const agent = (stagehand as any).agent({\n              model: validatedData.model,\n              systemPrompt: \"You're a helpful assistant that can control a web browser.\",\n            });\n            result = await agent.execute(validatedData.prompt);\n            addLog(\"Agent task completed\", \"success\", undefined, \"Multi-step task executed\");\n\n            generatedCode = `import { Stagehand } from \"@browserbasehq/stagehand\";\n\nconst stagehand = new Stagehand({\n  env: \"LOCAL\",\n  modelName: \"${validatedData.model}\",\n  enableCaching: true\n});\n\nawait stagehand.init();\nconst page = stagehand.context.pages()[0];\n\nawait page.goto(\"${validatedData.url}\");\n\nconst agent = stagehand.agent({\n  cua: true,\n  model: \"${validatedData.model}\",\n  systemPrompt: \"You're a helpful assistant that can control a web browser.\",\n});\n\nconst result = await agent.execute(\"${validatedData.prompt}\");\nconsole.log(\"Agent result:\", result);\n\nawait stagehand.close();`;\n            break;\n        }\n\n        await stagehand.close();\n        addLog(\"Browser session closed\", \"success\");\n\n        const response: AutomationResponse = {\n          success: true,\n          sessionId,\n          logs,\n          generatedCode: {\n            typescript: generatedCode,\n          },\n        };\n\n        res.json(response);\n      } catch (error) {\n        const errorMessage = error instanceof Error ? error.message : \"Unknown error occurred\";\n        addLog(\"Automation failed\", \"error\", undefined, errorMessage);\n\n        await stagehand.close().catch(() => {}); // Try to clean up\n\n        const response: AutomationResponse = {\n          success: false,\n          sessionId,\n          logs,\n          generatedCode: {},\n          error: errorMessage,\n        };\n\n        res.status(500).json(response);\n      }\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        res.status(400).json({\n          success: false,\n          error: \"Invalid request data\",\n          details: error.errors,\n        });\n      } else {\n        res.status(500).json({\n          success: false,\n          error: error instanceof Error ? error.message : \"Internal server error\",\n        });\n      }\n    }\n  });\n\n  // New unified automation endpoint with live WebSocket updates\n  app.post(\"/api/automate-unified\", async (req, res) => {\n    try {\n      const validatedData = unifiedAutomationRequestSchema.parse(req.body);\n      const sessionId = randomUUID();\n      const logs: LogEntry[] = [];\n      const usedModes: AutomationMode[] = [];\n\n      // Helper to add log entries and broadcast via WebSocket\n      const addLog = (action: string, status: LogEntry[\"status\"], selector?: string, description?: string) => {\n        const log: LogEntry = {\n          id: randomUUID(),\n          timestamp: Date.now(),\n          action,\n          status,\n          selector,\n          description,\n        };\n        logs.push(log);\n\n        // Broadcast to WebSocket clients\n        broadcastToSession(sessionId, {\n          type: \"log\",\n          sessionId,\n          log,\n        });\n      };\n\n      // Send initial response with sessionId\n      res.json({ sessionId });\n      console.log(\"===== AUTOMATION STARTING FOR SESSION:\", sessionId, \"=====\");\n\n      // Wrap the async continuation in a promise to catch errors\n      (async () => {\n        try {\n          // Parse the prompt to extract URL and determine mode\n          let parsedPrompt;\n          try {\n            parsedPrompt = parsePrompt(validatedData.prompt);\n            addLog(\n              \"Analyzed prompt\",\n              \"success\",\n              undefined,\n              `URL: ${parsedPrompt.url} | Mode: ${parsedPrompt.suggestedMode} | ${parsedPrompt.reasoning}`\n            );\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : \"Failed to parse prompt\";\n            console.error(\"Prompt parsing error:\", errorMessage);\n            addLog(\"Prompt analysis failed\", \"error\", undefined, errorMessage);\n            broadcastToSession(sessionId, {\n              type: \"error\",\n              sessionId,\n              error: errorMessage,\n            });\n            return;\n          }\n\n      // Check semantic cache for similar automation\n      addLog(\"Checking cache for similar automations\", \"running\");\n      const cachedAutomation = await findSimilarAutomation(\n        validatedData.prompt,\n        parsedPrompt.url\n      );\n\n      if (cachedAutomation) {\n        addLog(\n          \"Cache hit!\",\n          \"success\",\n          undefined,\n          `Found similar automation (${Math.round(cachedAutomation.similarity * 100)}% match). Reusing cached result - 0 AI usage!`\n        );\n\n        const response: AutomationResponse = {\n          success: true,\n          sessionId,\n          logs: [...logs, ...cachedAutomation.automation.logs],\n          generatedCode: {\n            ...cachedAutomation.automation.generatedCode,\n            cached: \"This result was retrieved from semantic cache - no AI credits used!\",\n          },\n          detectedUrl: cachedAutomation.automation.detectedUrl || parsedPrompt.url,\n          usedModes: [cachedAutomation.automation.mode as AutomationMode],\n          screenshot: cachedAutomation.automation.screenshot || undefined,\n        };\n\n        broadcastToSession(sessionId, {\n          type: \"complete\",\n          sessionId,\n          response,\n        });\n        return;\n      }\n\n      addLog(\"No cache hit, executing automation\", \"running\");\n\n      addLog(\"Initializing browser session\", \"running\", undefined, `Using model: ${validatedData.model}`);\n\n      // Initialize Stagehand with custom or default LLM client\n      const stagehand = createStagehandInstance(validatedData.model);\n\n      try {\n        await stagehand.init();\n        addLog(\"Browser session initialized\", \"success\");\n\n        const page = stagehand.context.pages()[0];\n        const capturedSteps: StagehandStep[] = [];\n\n        // Navigate to URL\n        addLog(`Navigating to ${parsedPrompt.url}`, \"running\");\n        await page.goto(parsedPrompt.url, { waitUntil: \"networkidle\" });\n        addLog(`Loaded ${parsedPrompt.url}`, \"success\");\n\n        let result: any;\n        const mode = parsedPrompt.suggestedMode;\n        usedModes.push(mode);\n\n        // Execute based on suggested mode\n        switch (mode) {\n          case \"act\":\n            addLog(`Observing target element for: ${parsedPrompt.task}`, \"running\");\n            // Use observe to get selector info before acting\n            let observeResults: any[] = [];\n            try {\n              observeResults = await (stagehand as any).observe(parsedPrompt.task);\n            } catch (observeError) {\n              console.log(\"Observe failed, will use direct act():\", observeError);\n            }\n\n            if (Array.isArray(observeResults) && observeResults.length > 0) {\n              const firstResult = observeResults[0];\n              addLog(`Found element: ${firstResult.description || 'target'}`, \"success\", firstResult.selector);\n\n              // Capture step for locator generation\n              const step = normalizeStep(\n                firstResult.method || firstResult.action || 'click',\n                firstResult.selector,\n                firstResult.description,\n                firstResult.arguments?.[0]\n              );\n              capturedSteps.push(step);\n\n              // Highlight element before interacting\n              try {\n                if (firstResult.selector) {\n                  const locator = page.locator(firstResult.selector);\n                  await locator.highlight();\n                  await page.waitForTimeout(1000); // Wait to show highlight\n                  addLog(\"Element highlighted\", \"success\", firstResult.selector);\n                }\n              } catch (highlightError) {\n                console.log(\"Could not highlight element:\", highlightError);\n              }\n\n              // Act on the observed element\n              addLog(`Executing action: ${parsedPrompt.task}`, \"running\");\n              result = await (stagehand as any).act(firstResult);\n              addLog(\"Action completed\", \"success\", undefined, \"Element interacted successfully\");\n            } else {\n              // Fallback to direct act if observe fails\n              addLog(`Executing action directly: ${parsedPrompt.task}`, \"running\");\n              result = await (stagehand as any).act(parsedPrompt.task);\n\n              // Still capture the action even without a specific selector\n              // Note: This step won't have a selector, so generated code will be a comment\n              capturedSteps.push({\n                action: \"click\",\n                description: `Action performed (selector not captured): ${parsedPrompt.task}`,\n              });\n\n              addLog(\"Action completed\", \"success\", undefined, \"Element interacted successfully (selector not captured for rerunnable code)\");\n            }\n            break;\n\n          case \"observe\":\n            addLog(`Observing: ${parsedPrompt.task}`, \"running\");\n            result = await (stagehand as any).observe(parsedPrompt.task);\n\n            // Capture observe results and highlight found elements\n            if (Array.isArray(result)) {\n              for (const obs of result) {\n                const step = normalizeStep(\n                  obs.method || obs.action || 'click',\n                  obs.selector,\n                  obs.description\n                );\n                capturedSteps.push(step);\n\n                // Highlight each observed element\n                try {\n                  if (obs.selector) {\n                    const locator = page.locator(obs.selector);\n                    await locator.highlight();\n                    await page.waitForTimeout(1500); // Wait to show highlight\n                  }\n                } catch (highlightError) {\n                  console.log(\"Could not highlight observed element:\", highlightError);\n                }\n              }\n            }\n\n            addLog(\n              \"Observation completed\",\n              \"success\",\n              undefined,\n              `Found and highlighted ${Array.isArray(result) ? result.length : 0} elements`\n            );\n            break;\n\n          case \"extract\":\n            addLog(`Extracting: ${parsedPrompt.task}`, \"running\");\n            const extractSchema = z.object({\n              data: z.string().describe(parsedPrompt.task)\n            });\n            result = await (stagehand as any).extract(parsedPrompt.task, extractSchema);\n\n            // Capture extract step (doesn't have specific selectors, but note the action)\n            capturedSteps.push({\n              action: \"extract\",\n              description: parsedPrompt.task,\n            });\n\n            addLog(\"Extraction completed\", \"success\", undefined, JSON.stringify(result, null, 2));\n            break;\n\n          case \"agent\":\n            addLog(`Running agent: ${parsedPrompt.task}`, \"running\");\n            const agent = (stagehand as any).agent({\n              model: validatedData.model,\n              systemPrompt: \"You're a helpful automation assistant that can control a web browser.\",\n            });\n            result = await agent.execute({\n              instruction: parsedPrompt.task,\n              highlightCursor: true, // Enable visual cursor to show interactions\n            });\n\n            // For agent, we note it as a multi-step workflow\n            capturedSteps.push({\n              action: \"agent\" as any,\n              description: `Agent workflow: ${parsedPrompt.task}`,\n            });\n\n            addLog(\n              \"Agent task completed\",\n              \"success\",\n              undefined,\n              `Completed: ${result.completed} | ${result.message}`\n            );\n            break;\n        }\n\n        // Capture screenshot before closing\n        addLog(\"Capturing screenshot\", \"running\");\n        let screenshot: string | null = null;\n        try {\n          const screenshotBuffer = await page.screenshot({\n            type: 'png',\n            fullPage: false,\n          });\n          screenshot = screenshotBuffer.toString('base64');\n          addLog(\"Screenshot captured\", \"success\");\n        } catch (screenshotError) {\n          console.error(\"Failed to capture screenshot:\", screenshotError);\n          addLog(\"Screenshot capture failed\", \"error\", undefined, \"Non-critical error\");\n        }\n\n        await stagehand.close();\n        addLog(\"Browser session closed\", \"success\");\n\n        const generatedCode = generateCodeForMode(\n          mode,\n          parsedPrompt.url,\n          parsedPrompt.task,\n          validatedData.model\n        );\n\n        // Generate locator-based rerunnable code\n        let locatorCode = '';\n        if (capturedSteps.length > 0) {\n          addLog(\"Generating rerunnable locator code\", \"running\");\n          try {\n            locatorCode = emitLocatorScript({\n              url: parsedPrompt.url,\n              model: validatedData.model,\n              mode,\n              steps: capturedSteps,\n            });\n            addLog(\"Generated rerunnable code with locators\", \"success\");\n          } catch (locatorError) {\n            console.error(\"Failed to generate locator code:\", locatorError);\n            addLog(\"Locator code generation failed\", \"error\", undefined, \"Non-critical error\");\n          }\n        }\n\n        const response: AutomationResponse = {\n          success: true,\n          sessionId,\n          logs,\n          generatedCode: {\n            typescript: generatedCode,\n            locators: locatorCode || undefined,\n          },\n          detectedUrl: parsedPrompt.url,\n          usedModes,\n          screenshot: screenshot ? `data:image/png;base64,${screenshot}` : undefined,\n        };\n\n        // Save to semantic cache for future reuse\n        await saveAutomation({\n          prompt: validatedData.prompt,\n          detectedUrl: parsedPrompt.url,\n          mode,\n          model: validatedData.model,\n          success: true,\n          sessionId,\n          logs,\n          generatedCode: {\n            typescript: generatedCode,\n            locators: locatorCode || undefined,\n          },\n          screenshot: screenshot ? `data:image/png;base64,${screenshot}` : null,\n          error: null,\n        });\n\n        addLog(\"Saved to cache\", \"success\", undefined, \"Future similar prompts will reuse this automation!\");\n\n        broadcastToSession(sessionId, {\n          type: \"complete\",\n          sessionId,\n          response,\n        });\n      } catch (error) {\n        const errorMessage = error instanceof Error ? error.message : \"Unknown error occurred\";\n        addLog(\"Automation failed\", \"error\", undefined, errorMessage);\n\n        await stagehand.close().catch(() => {});\n\n        broadcastToSession(sessionId, {\n          type: \"error\",\n          sessionId,\n          error: errorMessage,\n        });\n      }\n        } catch (asyncError) {\n          console.error(\"Automation async error:\", asyncError);\n          const errorMessage = asyncError instanceof Error ? asyncError.message : \"Unknown error occurred\";\n          broadcastToSession(sessionId, {\n            type: \"error\",\n            sessionId,\n            error: errorMessage,\n          });\n        }\n      })().catch(err => console.error(\"Fatal async error:\", err));\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        res.status(400).json({\n          success: false,\n          error: \"Invalid request data\",\n          details: error.errors,\n        });\n      } else {\n        res.status(500).json({\n          success: false,\n          error: error instanceof Error ? error.message : \"Internal server error\",\n        });\n      }\n    }\n  });\n\n  // History management routes\n  app.get(\"/api/history\", async (req, res) => {\n    try {\n      const { fetchAllHistory } = await import(\"./api-client\");\n      const history = await fetchAllHistory();\n\n      res.json({ success: true, history });\n    } catch (error) {\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : \"Failed to fetch history\",\n      });\n    }\n  });\n\n  app.delete(\"/api/history/:id\", async (req, res) => {\n    try {\n      const { deleteHistory } = await import(\"./api-client\");\n\n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ success: false, error: \"Invalid ID\" });\n      }\n\n      const result = await deleteHistory(id);\n\n      res.json({ success: true, message: result.message });\n    } catch (error) {\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : \"Failed to delete history item\",\n      });\n    }\n  });\n\n  app.delete(\"/api/history\", async (req, res) => {\n    try {\n      const { deleteAllHistory } = await import(\"./api-client\");\n\n      const result = await deleteAllHistory();\n\n      res.json({ success: true, message: result.message });\n    } catch (error) {\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : \"Failed to delete all history\",\n      });\n    }\n  });\n\n  app.post(\"/api/history/:id/reexecute\", async (req, res) => {\n    try {\n      const { fetchHistoryById } = await import(\"./api-client\");\n\n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ success: false, error: \"Invalid ID\" });\n      }\n\n      const historyItem = await fetchHistoryById(id);\n\n      if (!historyItem) {\n        return res.status(404).json({ success: false, error: \"History item not found\" });\n      }\n\n      res.json({\n        success: true,\n        prompt: historyItem.prompt,\n        model: historyItem.model,\n      });\n    } catch (error) {\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : \"Failed to reexecute\",\n      });\n    }\n  });\n\n  // Cache viewing route\n  app.get(\"/api/cache\", async (req, res) => {\n    try {\n      const { fetchCache } = await import(\"./api-client\");\n\n      const cache = await fetchCache();\n\n      res.json({ success: true, cache });\n    } catch (error) {\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : \"Failed to fetch cache\",\n      });\n    }\n  });\n\n  const httpServer = createServer(app);\n\n  // Setup WebSocket server\n  setupWebSocket(httpServer);\n\n  return httpServer;\n}\n","size_bytes":23559},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ThemeToggle.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\nexport default function ThemeToggle() {\n  const [theme, setTheme] = useState<\"light\" | \"dark\">(\"light\");\n\n  useEffect(() => {\n    const isDark = document.documentElement.classList.contains(\"dark\");\n    setTheme(isDark ? \"dark\" : \"light\");\n  }, []);\n\n  const toggleTheme = () => {\n    const newTheme = theme === \"light\" ? \"dark\" : \"light\";\n    setTheme(newTheme);\n    document.documentElement.classList.toggle(\"dark\");\n  };\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === \"light\" ? <Moon className=\"h-5 w-5\" /> : <Sun className=\"h-5 w-5\" />}\n    </Button>\n  );\n}\n","size_bytes":806},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"README.md":{"content":"# VisionVault\n\n**AI-Powered Browser Automation with Rerunnable Code Generation**\n\nVisionVault transforms natural language instructions into browser automations and generates rerunnable Playwright code with XPath locators—no LLM calls needed for re-execution.\n\n![VisionVault Demo](https://img.shields.io/badge/Status-Production%20Ready-success)\n![Node.js](https://img.shields.io/badge/Node.js-v20+-green)\n![PostgreSQL](https://img.shields.io/badge/PostgreSQL-v14+-blue)\n\n## ✨ Features\n\n- 🤖 **Natural Language Automation** - Describe tasks in plain English\n- 📝 **Locator-Based Code Generation** - Generates rerunnable Playwright code with XPath\n- 🔄 **Semantic Caching** - Reuses similar automations using Gemini embeddings\n- 👁️ **Element Highlighting** - Visual feedback during automation\n- 📸 **Screenshot Capture** - Automatic screenshots of results\n- 📊 **Execution History** - View and re-run past automations\n- 💾 **Smart Storage** - PostgreSQL + pgvector for semantic search\n\n## 🚀 Quick Start\n\n### Prerequisites\n\n- Node.js v20+\n- PostgreSQL v14+\n- Gemini or OpenAI API key\n\n### Installation\n\n```bash\n# Clone the repository\ngit clone <your-repo-url>\ncd visionvault\n\n# Install dependencies\nnpm install\n\n# Setup database (see LOCAL_SETUP.md for details)\ncreatedb visionvault\npsql -d visionvault -c \"CREATE EXTENSION IF NOT EXISTS vector;\"\n\n# Configure environment\ncp .env.example .env\n# Add your API keys and database credentials\n\n# Push database schema\nnpm run db:push\n\n# Start development server\nnpm run dev\n```\n\nVisit http://localhost:5000 and start automating!\n\n## 📖 Documentation\n\n- **[Local Setup Guide](./LOCAL_SETUP.md)** - Detailed installation and configuration\n- **[API Documentation](#)** - API endpoints and usage (coming soon)\n\n## 🏗️ Architecture\n\n```\n┌─────────────────────────────────────────┐\n│           VisionVault Frontend          │\n│   React + Vite + TailwindCSS + shadcn   │\n└──────────────────┬──────────────────────┘\n                   │ WebSocket + REST API\n┌──────────────────┴──────────────────────┐\n│       Express.js Backend Server         │\n│    Natural Language → Automation        │\n└──────────────────┬──────────────────────┘\n                   │\n    ┌──────────────┼──────────────┐\n    │              │              │\n┌───▼────┐  ┌──────▼─────┐  ┌───▼────┐\n│Stagehand│  │  PostgreSQL │  │ Gemini │\n│(Playwright)│  │+ pgvector  │  │  AI   │\n└─────────┘  └────────────┘  └────────┘\n```\n\n**Tech Stack:**\n- **Frontend**: React, Vite, TailwindCSS, shadcn/ui\n- **Backend**: Express.js, TypeScript\n- **Database**: PostgreSQL, Drizzle ORM, pgvector\n- **Automation**: Stagehand (Playwright wrapper)\n- **AI**: Google Gemini 2.5 Flash (or OpenAI GPT-4)\n\n## 💡 Usage Examples\n\n### Simple Click Action\n```\nGo to github.com and click the sign in button\n```\n\n### Form Filling\n```\nNavigate to example.com, fill the email field with test@email.com, and submit the form\n```\n\n### Data Extraction\n```\nGo to news.ycombinator.com and extract the top 5 story titles\n```\n\n### Multi-Step Agent\n```\nGo to amazon.com, search for \"wireless mouse\", and add the first result to cart\n```\n\n## 🎯 How It Works\n\n1. **Natural Language Parsing** - Intelligent prompt analysis extracts URL and task\n2. **Semantic Cache Check** - Searches for similar past automations (0.85 similarity)\n3. **Browser Automation** - Stagehand executes using AI vision models\n4. **Step Capture** - Records all interactions with XPath selectors\n5. **Code Generation** - Creates two versions:\n   - **Locator-based**: Rerunnable Playwright code (no AI needed)\n   - **Template-based**: Starter code with your specific task\n6. **Result Storage** - Saves to PostgreSQL with vector embeddings\n\n## 🔧 Configuration\n\n### Environment Variables\n\n```bash\n# Database\nDATABASE_URL=postgresql://user:pass@localhost:5432/visionvault\n\n# AI Models (choose one or both)\nGOOGLE_AI_API_KEY=your_gemini_key\nOPENAI_API_KEY=your_openai_key\n\n# Environment\nNODE_ENV=development\n```\n\n## 📦 Project Structure\n\n```\nvisionvault/\n├── client/               # React frontend\n│   ├── src/\n│   │   ├── pages/       # Route pages (Home, History, Cache)\n│   │   ├── components/  # UI components\n│   │   └── lib/         # Utilities\n├── server/              # Express backend\n│   ├── index.ts         # Server entry\n│   ├── routes.ts        # API endpoints\n│   ├── locator-generator.ts  # Code generation\n│   ├── intelligent-router.ts # Prompt parsing\n│   └── semantic-cache.ts     # Vector search\n├── shared/              # Shared types\n│   └── schema.ts        # Database schemas\n└── package.json\n```\n\n## 🛠️ Development\n\n```bash\n# Start dev server with hot reload\nnpm run dev\n\n# Type checking\nnpm run check\n\n# Build for production\nnpm run build\n\n# Start production server\nnpm run start\n\n# Database management\nnpm run db:push         # Push schema changes\nnpm run db:studio       # Open database GUI\n```\n\n## 🤝 Contributing\n\nContributions are welcome! Please feel free to submit a Pull Request.\n\n## 📄 License\n\nMIT License - see LICENSE file for details\n\n## 🙏 Acknowledgments\n\n- [Stagehand](https://github.com/browserbase/stagehand) - Browser automation framework\n- [Drizzle ORM](https://orm.drizzle.team/) - TypeScript ORM\n- [shadcn/ui](https://ui.shadcn.com/) - Beautiful UI components\n- [pgvector](https://github.com/pgvector/pgvector) - Vector similarity search\n\n---\n\n**Need help?** Check out the [Local Setup Guide](./LOCAL_SETUP.md) for detailed instructions.\n","size_bytes":6168},"server/main.py":{"content":"from fastapi import FastAPI, Depends, HTTPException\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom sqlalchemy.orm import Session\nfrom typing import List, Optional\nfrom pydantic import BaseModel\nfrom datetime import datetime\nimport json\nimport numpy as np\n\nfrom server.database import get_db, init_db\nfrom server.models import AutomationHistory\n\ndef cosine_similarity(a: List[float], b: List[float]) -> float:\n    \"\"\"Calculate cosine similarity between two vectors\"\"\"\n    if not a or not b or len(a) != len(b):\n        return 0.0\n    \n    a_np = np.array(a)\n    b_np = np.array(b)\n    \n    dot_product = np.dot(a_np, b_np)\n    norm_a = np.linalg.norm(a_np)\n    norm_b = np.linalg.norm(b_np)\n    \n    if norm_a == 0 or norm_b == 0:\n        return 0.0\n        \n    return float(dot_product / (norm_a * norm_b))\n\napp = FastAPI(title=\"VisionVault API\")\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\nclass AutomationRequest(BaseModel):\n    prompt: str\n    detected_url: Optional[str] = None\n    mode: str\n    model: str\n    success: bool\n    session_id: str\n    logs: list\n    generated_code: dict\n    screenshot: Optional[str] = None\n    error: Optional[str] = None\n    prompt_embedding: Optional[list] = None\n\nclass AutomationResponse(BaseModel):\n    id: int\n    prompt: str\n    detectedUrl: Optional[str]\n    mode: str\n    model: str\n    success: bool\n    sessionId: str\n    logs: list\n    generatedCode: dict\n    screenshot: Optional[str]\n    error: Optional[str]\n    createdAt: str\n\n    class Config:\n        from_attributes = True\n\n@app.on_event(\"startup\")\nasync def startup():\n    init_db()\n    print(\"Database initialized\")\n\n@app.get(\"/\")\nasync def root():\n    return {\"message\": \"VisionVault API\", \"status\": \"running\"}\n\n@app.get(\"/api/history\")\nasync def get_history(db: Session = Depends(get_db)):\n    history = db.query(AutomationHistory).order_by(AutomationHistory.created_at.desc()).all()\n    return [h.to_dict() for h in history]\n\n@app.get(\"/api/history/{id}\")\nasync def get_history_by_id(id: int, db: Session = Depends(get_db)):\n    history = db.query(AutomationHistory).filter(AutomationHistory.id == id).first()\n    if not history:\n        raise HTTPException(status_code=404, detail=\"History not found\")\n    \n    return history.to_dict()\n\n@app.post(\"/api/history\")\nasync def create_history(request: AutomationRequest, db: Session = Depends(get_db)):\n    history = AutomationHistory(\n        prompt=request.prompt,\n        prompt_embedding=request.prompt_embedding,\n        detected_url=request.detected_url,\n        mode=request.mode,\n        model=request.model,\n        success=request.success,\n        session_id=request.session_id,\n        logs=request.logs,\n        generated_code=request.generated_code,\n        screenshot=request.screenshot,\n        error=request.error\n    )\n    \n    db.add(history)\n    db.commit()\n    db.refresh(history)\n    \n    return {\"id\": history.id, \"message\": \"History saved successfully\"}\n\n@app.delete(\"/api/history/{id}\")\nasync def delete_history(id: int, db: Session = Depends(get_db)):\n    history = db.query(AutomationHistory).filter(AutomationHistory.id == id).first()\n    if not history:\n        raise HTTPException(status_code=404, detail=\"History not found\")\n    \n    db.delete(history)\n    db.commit()\n    \n    return {\"message\": \"History deleted successfully\"}\n\n@app.delete(\"/api/history\")\nasync def delete_all_history(db: Session = Depends(get_db)):\n    db.query(AutomationHistory).delete()\n    db.commit()\n    \n    return {\"message\": \"All history deleted successfully\"}\n\n@app.get(\"/api/cache\")\nasync def get_cache(db: Session = Depends(get_db)):\n    cached = db.query(AutomationHistory).filter(\n        AutomationHistory.prompt_embedding.isnot(None)\n    ).order_by(AutomationHistory.created_at.desc()).all()\n    \n    return [h.to_dict() for h in cached]\n\nclass SimilarityRequest(BaseModel):\n    embedding: List[float]\n    threshold: float = 0.85\n    limit: int = 10\n\n@app.post(\"/api/similarity-search\")\nasync def similarity_search(request: SimilarityRequest, db: Session = Depends(get_db)):\n    \"\"\"Find similar automations based on embedding cosine similarity\"\"\"\n    all_history = db.query(AutomationHistory).filter(\n        AutomationHistory.prompt_embedding.isnot(None)\n    ).all()\n    \n    results = []\n    for h in all_history:\n        if h.prompt_embedding:\n            similarity = cosine_similarity(request.embedding, h.prompt_embedding)\n            if similarity >= request.threshold:\n                result = h.to_dict()\n                result['similarity'] = similarity\n                results.append(result)\n    \n    results.sort(key=lambda x: x['similarity'], reverse=True)\n    return results[:request.limit]\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n","size_bytes":4885},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/UnifiedAutomationInput.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Button } from \"@/components/ui/button\";\nimport { Mic, MicOff } from \"lucide-react\";\nimport { useSettings } from \"@/contexts/SettingsContext\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface UnifiedAutomationInputProps {\n  onExecute: (data: { prompt: string; model: string }) => void;\n  isExecuting: boolean;\n}\n\nexport default function UnifiedAutomationInput({\n  onExecute,\n  isExecuting,\n}: UnifiedAutomationInputProps) {\n  const [prompt, setPrompt] = useState(\"\");\n  const [isListening, setIsListening] = useState(false);\n  const [recognition, setRecognition] = useState<any>(null);\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const { model } = useSettings();\n  const { toast } = useToast();\n\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n      \n      if (SpeechRecognition) {\n        const recognitionInstance = new SpeechRecognition();\n        recognitionInstance.continuous = false;\n        recognitionInstance.interimResults = false;\n        recognitionInstance.lang = 'en-US';\n\n        recognitionInstance.onresult = (event: any) => {\n          const transcript = event.results[0][0].transcript;\n          setPrompt(transcript);\n          setIsListening(false);\n        };\n\n        recognitionInstance.onerror = (event: any) => {\n          console.error('Speech recognition error:', event.error);\n          setIsListening(false);\n          toast({\n            title: \"Voice input error\",\n            description: \"Could not recognize speech. Please try again.\",\n            variant: \"destructive\",\n          });\n        };\n\n        recognitionInstance.onend = () => {\n          setIsListening(false);\n        };\n\n        setRecognition(recognitionInstance);\n      }\n    }\n  }, [toast]);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (prompt.trim()) {\n      onExecute({ prompt, model });\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      if (prompt.trim()) {\n        onExecute({ prompt, model });\n        setPrompt(\"\");\n      }\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setPrompt(e.target.value);\n    autoResize();\n  };\n\n  const autoResize = () => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = \"auto\";\n      textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`;\n    }\n  };\n\n  useEffect(() => {\n    autoResize();\n  }, [prompt]);\n\n  const toggleVoiceInput = () => {\n    if (!recognition) {\n      toast({\n        title: \"Voice input not supported\",\n        description: \"Your browser doesn't support voice input. Please use Chrome, Edge, or Safari.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (isListening) {\n      recognition.stop();\n      setIsListening(false);\n    } else {\n      recognition.start();\n      setIsListening(true);\n      toast({\n        title: \"Listening...\",\n        description: \"Speak now to input your automation task\",\n      });\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"relative w-full\">\n      <Textarea\n        ref={textareaRef}\n        data-testid=\"input-prompt\"\n        placeholder=\"What do you want to automate?\"\n        value={prompt}\n        onChange={handleChange}\n        onKeyDown={handleKeyDown}\n        disabled={isExecuting}\n        className=\"w-full min-h-16 max-h-96 pl-16 pr-16 py-5 text-lg rounded-3xl shadow-sm border-2 focus-visible:ring-2 text-center placeholder:text-center resize-none overflow-y-auto\"\n        rows={1}\n      />\n      <button\n        type=\"button\"\n        onClick={toggleVoiceInput}\n        disabled={isExecuting}\n        data-testid=\"button-voice-input\"\n        className={`absolute right-5 top-5 h-8 w-8 flex items-center justify-center rounded-full hover:bg-muted/50 transition-colors ${\n          isListening ? 'text-red-500 animate-pulse' : 'text-muted-foreground hover:text-foreground'\n        } disabled:opacity-50 disabled:cursor-not-allowed`}\n      >\n        {isListening ? <MicOff className=\"h-5 w-5\" /> : <Mic className=\"h-5 w-5\" />}\n      </button>\n    </form>\n  );\n}\n","size_bytes":4404},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"OPENAI_EMBEDDINGS_SETUP.md":{"content":"# OpenAI Embeddings Setup Guide\n\nThis application uses **OpenAI text embeddings** for semantic caching of automation requests, powered by your custom OAuth-based LLM client.\n\n## Configuration\n\n### Required Environment Variables\n\nAdd these to your `.env` file or Replit Secrets:\n\n```bash\n# OpenAI Embedding Configuration\nOPENAI_EMBEDDING_ENDPOINT=https://api.openai.com/v1/embeddings\nOPENAI_EMBEDDING_MODEL=text-embedding-3-small\n\n# Custom LLM Configuration (for chat completions)\nCUSTOM_LLM_API_ENDPOINT=https://your-llm-endpoint.com/v1/chat/completions\nCUSTOM_LLM_MODEL_NAME=gpt-4o-1-2025-04-14-eastus-dz\n\n# Python API (for database operations)\nPYTHON_API_URL=http://localhost:8000\n```\n\n### OAuth Token Authentication\n\nBoth the embedding API and chat completion API use OAuth tokens fetched via `fetch_token.py`.\n\n**Edit `fetch_token.py`** to implement your token fetching logic:\n\n```python\ndef fetch_token():\n    # Option 1: Fetch from Azure OAuth endpoint\n    # import requests\n    # response = requests.post(\"https://login.microsoftonline.com/...\", ...)\n    \n    # Option 2: Use environment variable (development only)\n    token = os.getenv(\"CUSTOM_LLM_API_KEY\", \"\")\n    \n    if not token:\n        return {\"error\": \"No token available\"}\n    \n    return {\n        \"access_token\": token,\n        \"expires_in\": 3600  # Optional: token expiration in seconds\n    }\n```\n\n## Embedding Models\n\n### OpenAI Text Embedding Models\n\n| Model | Dimensions | Use Case |\n|-------|-----------|----------|\n| **text-embedding-3-small** | 1536 | Default - Fast, cost-effective |\n| **text-embedding-3-large** | 3072 | Higher accuracy, more expensive |\n| **text-embedding-ada-002** | 1536 | Legacy model |\n\n**Current Configuration:** `text-embedding-3-small` with **1536 dimensions**\n\n## How Semantic Caching Works\n\n1. **User submits automation request** with a natural language prompt\n2. **System generates embedding** (1536-dimensional vector) of the prompt using OpenAI\n3. **Similarity search** finds previously cached automations with similar prompts\n4. **Cache hit** (similarity ≥ 85%): Returns cached results instantly\n5. **Cache miss**: Executes automation and stores with embedding for future use\n\n### Example\n\n```\nUser 1: \"Go to Amazon and search for laptops\"\n→ Generates embedding → Executes automation → Caches result\n\nUser 2: \"Navigate to Amazon.com and look for laptop computers\"\n→ Generates embedding → Finds similar cached request (92% match)\n→ Returns cached results instantly ✨\n```\n\n## Database Schema\n\nThe `automation_history` table stores:\n- `prompt`: Original user prompt\n- `prompt_embedding`: 1536-dimensional vector (pgvector)\n- `generated_code`: Automation code snippets\n- `logs`, `screenshot`, and other metadata\n\nVector similarity search uses PostgreSQL's `pgvector` extension.\n\n## Testing\n\nTo test semantic caching:\n\n1. Submit an automation request\n2. Check logs for: `\"Saved automation with embedding (1536 dimensions)\"`\n3. Submit a similar request with different wording\n4. Look for: `\"Found similar automation with similarity: 0.XX\"`\n\n## Troubleshooting\n\n### \"No embedding generated\"\n- Check `fetch_token.py` returns valid OAuth token\n- Verify `OPENAI_EMBEDDING_ENDPOINT` is accessible\n- Check Python API is running on `PYTHON_API_URL`\n\n### \"OAuth token is invalid or missing\"\n- Ensure `fetch_token.py` returns `{\"access_token\": \"...\", \"expires_in\": 3600}`\n- Test manually: `python fetch_token.py`\n\n### Schema mismatch errors\nIf you see dimension errors, run:\n```bash\nnpm run db:push --force\n```\n\nThis syncs the schema with 1536 dimensions for OpenAI embeddings.\n","size_bytes":3589}},"version":2}